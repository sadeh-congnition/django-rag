<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="ROBOTS" content="ALL" />
    <meta name="MSSmartTagsPreventParsing" content="true" />
    <meta name="Copyright" content="Django Software Foundation" />
    <meta name="keywords" content="Python, Django, framework, open-source" />
    <meta name="description" content="" />
    <meta name="fediverse:creator" content="@django@fosstodon.org" />
    
  
    
      
    
  
  <link rel="canonical" href="https://docs.djangoproject.com/en/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="el"
          href="https://docs.djangoproject.com/el/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="en"
          href="https://docs.djangoproject.com/en/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="es"
          href="https://docs.djangoproject.com/es/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="fr"
          href="https://docs.djangoproject.com/fr/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="id"
          href="https://docs.djangoproject.com/id/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="it"
          href="https://docs.djangoproject.com/it/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="ja"
          href="https://docs.djangoproject.com/ja/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="ko"
          href="https://docs.djangoproject.com/ko/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="pl"
          href="https://docs.djangoproject.com/pl/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="pt-br"
          href="https://docs.djangoproject.com/pt-br/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="sv"
          href="https://docs.djangoproject.com/sv/6.0/ref/contrib/postgres/operations/">
  
    
      
    
    <link rel="alternate"
          hreflang="zh-hans"
          href="https://docs.djangoproject.com/zh-hans/6.0/ref/contrib/postgres/operations/">
  

  <link rel="search"
        type="application/opensearchdescription+xml"
        href="https://docs.djangoproject.com/en/6.0/search/description/"
        title="Django documentation">

    <!-- Favicons -->
    <link rel="apple-touch-icon" href="https://static.djangoproject.com/img/icon-touch.e4872c4da341.png">
    <link rel="icon" sizes="192x192" href="https://static.djangoproject.com/img/icon-touch.e4872c4da341.png">
    <link rel="shortcut icon" href="https://static.djangoproject.com/img/favicon.6dbf28c0650e.ico">
    <meta name="msapplication-TileColor" content="#113228">
    <meta name="msapplication-TileImage" content="https://static.djangoproject.com/img/icon-tile.b01ac0ef9f67.png">
    <meta name="theme-color" content="#0C4B33">

    
      <meta property="og:title" content="Database migration operations | Django documentation" />
      <meta property="og:description" content="The web framework for perfectionists with deadlines." />
      <meta property="og:image" content="https://static.djangoproject.com/img/logos/django-logo-negative.1d528e2cb5fb.png" />
      <meta property="og:image:alt" content="Django logo" />
      <meta property="og:image:width" content="1200" />
      <meta property="og:image:height" content="546" />
      <meta property="og:image:type" content="image/png"/>
      <meta property="og:url" content="https://docs.djangoproject.com/en/6.0/ref/contrib/postgres/operations/" />
      <meta property="og:site_name" content="Django Project" />

      <meta property="twitter:creator" content="djangoproject" />
      <meta property="twitter:site" content="djangoproject" />
      <meta property="twitter:card" content="summary">
    

    <title>Database migration operations | Django documentation | Django</title>

    <link rel="stylesheet" href="https://static.djangoproject.com/css/output.7f12b704d16e.css" >

    <script src="https://static.djangoproject.com/js/mod/switch-dark-mode.139625c684db.js"></script>
    
  </head>

  <body id="generic" class="">

    <a href="#main-content" class="skip-link">Skip to main content</a>
    

<header id="top">
  <div class="container container--flex--wrap--mobile">
    <a class="logo" href="https://www.djangoproject.com/">Django</a>
    <p class="meta">The web framework for perfectionists with deadlines.</p>
    <div class="header-mobile-only">
      
<search class="search form-input" aria-labelledby="docs-search-label">
  <form action="https://docs.djangoproject.com/en/6.0/search/">
    <label id="docs-search-label" class="visuallyhidden" for="id_q">Search</label>
    <input type="search" name="q" placeholder="Search" id="id_q">
    <input type="hidden" name="category" value="">

    <button type="submit">
      <i class="icon icon-search" aria-hidden="true"></i>
      <span class="visuallyhidden">Submit</span>
    </button>
  </form>
</search>

      <div class="light-dark-mode-toggle">
        

<button class="theme-toggle">
  <div class="visually-hidden theme-label-when-auto">Toggle theme (current theme: auto)</div>
  <div class="visually-hidden theme-label-when-light">Toggle theme (current theme: light)</div>
  <div class="visually-hidden theme-label-when-dark">Toggle theme (current theme: dark)</div>

  <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
  <svg aria-hidden="true" class="theme-icon-when-auto">
    <use xlink:href="#icon-auto" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-dark">
    <use xlink:href="#icon-moon" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-light">
    <use xlink:href="#icon-sun" />
  </svg>
</button>

      </div>
    </div>
    <button class="menu-button">
      <i class="icon icon-reorder"></i>
      <span class="visuallyhidden">Menu</span>
    </button>
    <nav aria-labelledby="navigation-header">
      <span id="navigation-header" class="visuallyhidden">Main navigation</span>
      <ul>
        <li>
          <a href="https://www.djangoproject.com/start/overview/">Overview</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/download/">Download</a>
        </li>
        <li class="active">
          <a href="https://docs.djangoproject.com/">Documentation</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/weblog/">News</a>
        </li>
        <li>
          <a href="https://github.com/django/django" target="_blank" rel="noopener">Code</a>
        </li>
        <li>
          <a href="https://code.djangoproject.com/">Issues</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/community/">Community</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/foundation/">Foundation</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/fundraising/">&#9829; Donate</a>
        </li>
        <li>
          
<search class="search form-input" aria-labelledby="docs-search-label">
  <form action="https://docs.djangoproject.com/en/6.0/search/">
    <label id="docs-search-label" class="visuallyhidden" for="id_q">Search</label>
    <input type="search" name="q" placeholder="Search" id="id_q">
    <input type="hidden" name="category" value="">

    <button type="submit">
      <i class="icon icon-search" aria-hidden="true"></i>
      <span class="visuallyhidden">Submit</span>
    </button>
  </form>
</search>

        </li>
        <li>
          

<button class="theme-toggle">
  <div class="visually-hidden theme-label-when-auto">Toggle theme (current theme: auto)</div>
  <div class="visually-hidden theme-label-when-light">Toggle theme (current theme: light)</div>
  <div class="visually-hidden theme-label-when-dark">Toggle theme (current theme: dark)</div>

  <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
  <svg aria-hidden="true" class="theme-icon-when-auto">
    <use xlink:href="#icon-auto" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-dark">
    <use xlink:href="#icon-moon" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-light">
    <use xlink:href="#icon-sun" />
  </svg>
</button>

        </li>
      </ul>
    </nav>
  </div>
</header>

    

    <section class="copy-banner">
      <div class="container 
  container--flex container--flex--wrap--mobile
">
        
  <p><a href="https://docs.djangoproject.com/en/6.0/">Documentation</a></p>

      </div>
    </section>

    <div id="billboard">
      
    </div>

    <div class="container sidebar-right">
      <main id="main-content">

        
          
        

        
  <div id="version-switcher">
    <ul id="faq-link">
      <li class="current-link">
        <a href="https://docs.djangoproject.com/en/6.0/faq/help/">
          <span>Getting Help</span>
        </a>
      </li>
    </ul>
    <ul id="doc-languages" class="language-switcher doc-switcher">
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/el/6.0/ref/contrib/postgres/operations/">el</a>
          </li>
        
      
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/es/6.0/ref/contrib/postgres/operations/">es</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/fr/6.0/ref/contrib/postgres/operations/">fr</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/id/6.0/ref/contrib/postgres/operations/">id</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/it/6.0/ref/contrib/postgres/operations/">it</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/ja/6.0/ref/contrib/postgres/operations/">ja</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/ko/6.0/ref/contrib/postgres/operations/">ko</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/pl/6.0/ref/contrib/postgres/operations/">pl</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/pt-br/6.0/ref/contrib/postgres/operations/">pt-br</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/sv/6.0/ref/contrib/postgres/operations/">sv</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/zh-hans/6.0/ref/contrib/postgres/operations/">zh-hans</a>
          </li>
        
      
      <li class="current"
          title="Click on the links on the left to switch to another language.">
        <span>Language: <strong>en</strong></span>
      </li>
    </ul>

    
    <ul id="doc-versions" class="version-switcher doc-switcher">
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/postgres/operations/">1.8</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/1.10/ref/contrib/postgres/operations/">1.10</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/1.11/ref/contrib/postgres/operations/">1.11</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/2.0/ref/contrib/postgres/operations/">2.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/2.1/ref/contrib/postgres/operations/">2.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/2.2/ref/contrib/postgres/operations/">2.2</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/3.0/ref/contrib/postgres/operations/">3.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/3.1/ref/contrib/postgres/operations/">3.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/3.2/ref/contrib/postgres/operations/">3.2</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/postgres/operations/">4.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/4.1/ref/contrib/postgres/operations/">4.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/4.2/ref/contrib/postgres/operations/">4.2</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/5.0/ref/contrib/postgres/operations/">5.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/5.1/ref/contrib/postgres/operations/">5.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/5.2/ref/contrib/postgres/operations/">5.2</a>
          </li>
        
      
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/dev/ref/contrib/postgres/operations/">dev</a>
          </li>
        
      
      <li class="current"
          title="This document describes Django 6.0. Click on the links on the left to see other versions.">
        <span>Documentation version:
          <strong>6.0</strong>
        </span>
      </li>
    </ul>
    <ul id="backtotop-link">
      <li class="current-link">
        <a href="#top" aria-label="Back to top" class="icon-chevron-up-align"><i class="icon icon-chevron-up"></i></a>
      </li>
    </ul>
  </div>

  
    <article id="docs-content">
      <section id="s-database-migration-operations">
<span id="database-migration-operations"></span><h1>Database migration operations<a class="headerlink" href="#database-migration-operations" title="Link to this heading">¶</a></h1>
<p>All of these <a class="reference internal" href="../../../migration-operations/"><span class="doc">operations</span></a> are available from
the <code class="docutils literal notranslate"><span class="pre">django.contrib.postgres.operations</span></code> module.</p>
<section id="s-creating-extension-using-migrations">
<span id="s-create-postgresql-extensions"></span><span id="creating-extension-using-migrations"></span><span id="create-postgresql-extensions"></span><h2>Creating extension using migrations<a class="headerlink" href="#creating-extension-using-migrations" title="Link to this heading">¶</a></h2>
<p>You can create a PostgreSQL extension in your database using a migration file.
This example creates an hstore extension, but the same principles apply for
other extensions.</p>
<p>Set up the hstore extension in PostgreSQL before the first <code class="docutils literal notranslate"><span class="pre">CreateModel</span></code>
or <code class="docutils literal notranslate"><span class="pre">AddField</span></code> operation that involves
<a class="reference internal" href="../fields/#django.contrib.postgres.fields.HStoreField" title="django.contrib.postgres.fields.HStoreField"><code class="xref py py-class docutils literal notranslate"><span class="pre">HStoreField</span></code></a> by adding a migration with
the <a class="reference internal" href="#django.contrib.postgres.operations.HStoreExtension" title="django.contrib.postgres.operations.HStoreExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">HStoreExtension</span></code></a> operation.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.postgres.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">HStoreExtension</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span><span class="n">HStoreExtension</span><span class="p">(),</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>The operation skips adding the extension if it already exists.</p>
<p>For most extensions, this requires a database user with superuser privileges.
If the Django database user doesn’t have the appropriate privileges, you’ll
have to create the extension outside of Django migrations with a user that has
them. In that case, connect to your Django database and run the query
<code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTENSION</span> <span class="pre">IF</span> <span class="pre">NOT</span> <span class="pre">EXISTS</span> <span class="pre">hstore;</span></code>.</p>
</section>
<section id="s-createextension">
<span id="createextension"></span><h2><code class="docutils literal notranslate"><span class="pre">CreateExtension</span></code><a class="headerlink" href="#createextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CreateExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CreateExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L12"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.CreateExtension" title="Link to this definition">¶</a></dt>
<dd><p>An <code class="docutils literal notranslate"><span class="pre">Operation</span></code> subclass which installs a PostgreSQL extension. For common
extensions, use one of the more specific subclasses below.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CreateExtension.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#django.contrib.postgres.operations.CreateExtension.name" title="Link to this definition">¶</a></dt>
<dd><p>This is a required argument. The name of the extension to be installed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CreateExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.CreateExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-bloomextension">
<span id="bloomextension"></span><h2><code class="docutils literal notranslate"><span class="pre">BloomExtension</span></code><a class="headerlink" href="#bloomextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.BloomExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BloomExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.BloomExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">bloom</span></code> extension.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.BloomExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.BloomExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-btreeginextension">
<span id="btreeginextension"></span><h2><code class="docutils literal notranslate"><span class="pre">BtreeGinExtension</span></code><a class="headerlink" href="#btreeginextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.BtreeGinExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BtreeGinExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L79"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.BtreeGinExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">btree_gin</span></code> extension.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.BtreeGinExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.BtreeGinExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-btreegistextension">
<span id="btreegistextension"></span><h2><code class="docutils literal notranslate"><span class="pre">BtreeGistExtension</span></code><a class="headerlink" href="#btreegistextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.BtreeGistExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BtreeGistExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L84"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.BtreeGistExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">btree_gist</span></code> extension.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.BtreeGistExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.BtreeGistExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-citextextension">
<span id="citextextension"></span><h2><code class="docutils literal notranslate"><span class="pre">CITextExtension</span></code><a class="headerlink" href="#citextextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CITextExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CITextExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L89"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.CITextExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">citext</span></code> extension.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CITextExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.CITextExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-cryptoextension">
<span id="cryptoextension"></span><h2><code class="docutils literal notranslate"><span class="pre">CryptoExtension</span></code><a class="headerlink" href="#cryptoextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CryptoExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CryptoExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L94"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.CryptoExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code> extension.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CryptoExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.CryptoExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-hstoreextension">
<span id="hstoreextension"></span><h2><code class="docutils literal notranslate"><span class="pre">HStoreExtension</span></code><a class="headerlink" href="#hstoreextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.HStoreExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HStoreExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L99"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.HStoreExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">hstore</span></code> extension and also sets up the connection to
interpret hstore data for possible use in subsequent migrations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.HStoreExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.HStoreExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-trigramextension">
<span id="trigramextension"></span><h2><code class="docutils literal notranslate"><span class="pre">TrigramExtension</span></code><a class="headerlink" href="#trigramextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.TrigramExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TrigramExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L104"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.TrigramExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">pg_trgm</span></code> extension.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.TrigramExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.TrigramExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-unaccentextension">
<span id="unaccentextension"></span><h2><code class="docutils literal notranslate"><span class="pre">UnaccentExtension</span></code><a class="headerlink" href="#unaccentextension" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.UnaccentExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UnaccentExtension</span></span>(<em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L109"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.UnaccentExtension" title="Link to this definition">¶</a></dt>
<dd><p>Installs the <code class="docutils literal notranslate"><span class="pre">unaccent</span></code> extension.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.UnaccentExtension.hints">
<span class="sig-name descname"><span class="pre">hints</span></span><a class="headerlink" href="#django.contrib.postgres.operations.UnaccentExtension.hints" title="Link to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 6.0.</span> </div>
<p>The optional <code class="docutils literal notranslate"><span class="pre">hints</span></code> argument will be passed as <code class="docutils literal notranslate"><span class="pre">**hints</span></code> to the
<a class="reference internal" href="../../../../topics/db/multi-db/#allow_migrate" title="allow_migrate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">allow_migrate()</span></code></a> method of database routers to assist them in
<a class="reference internal" href="../../../../topics/db/multi-db/#topics-db-multi-db-hints"><span class="std std-ref">making routing decisions</span></a>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="s-managing-collations-using-migrations">
<span id="s-manage-postgresql-collations"></span><span id="managing-collations-using-migrations"></span><span id="manage-postgresql-collations"></span><h2>Managing collations using migrations<a class="headerlink" href="#managing-collations-using-migrations" title="Link to this heading">¶</a></h2>
<p>If you need to filter or order a column using a particular collation that your
operating system provides but PostgreSQL does not, you can manage collations in
your database using a migration file. These collations can then be used with
the <code class="docutils literal notranslate"><span class="pre">db_collation</span></code> parameter on <a class="reference internal" href="../../../models/fields/#django.db.models.CharField" title="django.db.models.CharField"><code class="xref py py-class docutils literal notranslate"><span class="pre">CharField</span></code></a>,
<a class="reference internal" href="../../../models/fields/#django.db.models.TextField" title="django.db.models.TextField"><code class="xref py py-class docutils literal notranslate"><span class="pre">TextField</span></code></a>, and their subclasses.</p>
<p>For example, to create a collation for German phone book ordering:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.postgres.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">CreateCollation</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">CreateCollation</span><span class="p">(</span>
            <span class="s2">&quot;case_insensitive&quot;</span><span class="p">,</span>
            <span class="n">provider</span><span class="o">=</span><span class="s2">&quot;icu&quot;</span><span class="p">,</span>
            <span class="n">locale</span><span class="o">=</span><span class="s2">&quot;und-u-ks-level2&quot;</span><span class="p">,</span>
            <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="o">...</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.CreateCollation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CreateCollation</span></span>(<em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'libc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L219"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.CreateCollation" title="Link to this definition">¶</a></dt>
<dd><p>Creates a collation with the given <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">locale</span></code> and <code class="docutils literal notranslate"><span class="pre">provider</span></code>.</p>
<p>Set the <code class="docutils literal notranslate"><span class="pre">deterministic</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">False</span></code> to create a
non-deterministic collation, such as for case-insensitive filtering.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.RemoveCollation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RemoveCollation</span></span>(<em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locale</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provider</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'libc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L249"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.RemoveCollation" title="Link to this definition">¶</a></dt>
<dd><p>Removes the collations named <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
<p>When reversed this is creating a collation with the provided <code class="docutils literal notranslate"><span class="pre">locale</span></code>,
<code class="docutils literal notranslate"><span class="pre">provider</span></code>, and <code class="docutils literal notranslate"><span class="pre">deterministic</span></code> arguments. Therefore, <code class="docutils literal notranslate"><span class="pre">locale</span></code> is
required to make this operation reversible.</p>
</dd></dl>

</section>
<section id="s-concurrent-index-operations">
<span id="concurrent-index-operations"></span><h2>Concurrent index operations<a class="headerlink" href="#concurrent-index-operations" title="Link to this heading">¶</a></h2>
<p>PostgreSQL supports the <code class="docutils literal notranslate"><span class="pre">CONCURRENTLY</span></code> option to <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">INDEX</span></code> and
<code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">INDEX</span></code> statements to add and remove indexes without locking out writes.
This option is useful for adding or removing an index in a live production
database.</p>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.AddIndexConcurrently">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AddIndexConcurrently</span></span>(<em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L123"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.AddIndexConcurrently" title="Link to this definition">¶</a></dt>
<dd><p>Like <a class="reference internal" href="../../../migration-operations/#django.db.migrations.operations.AddIndex" title="django.db.migrations.operations.AddIndex"><code class="xref py py-class docutils literal notranslate"><span class="pre">AddIndex</span></code></a>, but creates an
index with the <code class="docutils literal notranslate"><span class="pre">CONCURRENTLY</span></code> option. This has a few caveats to be aware
of when using this option, see <a class="reference external" href="https://www.postgresql.org/docs/current/sql-createindex.html#SQL-CREATEINDEX-CONCURRENTLY">the PostgreSQL documentation of building
indexes concurrently</a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.RemoveIndexConcurrently">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RemoveIndexConcurrently</span></span>(<em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L149"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.RemoveIndexConcurrently" title="Link to this definition">¶</a></dt>
<dd><p>Like <a class="reference internal" href="../../../migration-operations/#django.db.migrations.operations.RemoveIndex" title="django.db.migrations.operations.RemoveIndex"><code class="xref py py-class docutils literal notranslate"><span class="pre">RemoveIndex</span></code></a>, but removes the
index with the <code class="docutils literal notranslate"><span class="pre">CONCURRENTLY</span></code> option. This has a few caveats to be aware
of when using this option, see <a class="reference external" href="https://www.postgresql.org/docs/current/sql-dropindex.html">the PostgreSQL documentation</a>.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">CONCURRENTLY</span></code> option is not supported inside a transaction (see
<a class="reference internal" href="../../../../howto/writing-migrations/#non-atomic-migrations"><span class="std std-ref">non-atomic migration</span></a>).</p>
</div>
</section>
<section id="s-adding-constraints-without-enforcing-validation">
<span id="adding-constraints-without-enforcing-validation"></span><h2>Adding constraints without enforcing validation<a class="headerlink" href="#adding-constraints-without-enforcing-validation" title="Link to this heading">¶</a></h2>
<p>PostgreSQL supports the <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">VALID</span></code> option with the <code class="docutils literal notranslate"><span class="pre">ADD</span> <span class="pre">CONSTRAINT</span></code>
statement to add check constraints without enforcing validation on existing
rows. This option is useful if you want to skip the potentially lengthy scan of
the table to verify that all existing rows satisfy the constraint.</p>
<p>To validate check constraints created with the <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">VALID</span></code> option at a later
point of time, use the
<a class="reference internal" href="#django.contrib.postgres.operations.ValidateConstraint" title="django.contrib.postgres.operations.ValidateConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValidateConstraint</span></code></a> operation.</p>
<p>See <a class="reference external" href="https://www.postgresql.org/docs/current/sql-altertable.html#SQL-ALTERTABLE-NOTES">the PostgreSQL documentation</a> for more details.</p>
<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.AddConstraintNotValid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AddConstraintNotValid</span></span>(<em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraint</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L274"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.AddConstraintNotValid" title="Link to this definition">¶</a></dt>
<dd><p>Like <a class="reference internal" href="../../../migration-operations/#django.db.migrations.operations.AddConstraint" title="django.db.migrations.operations.AddConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">AddConstraint</span></code></a>, but avoids
validating the constraint on existing rows.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="django.contrib.postgres.operations.ValidateConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ValidateConstraint</span></span>(<em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/contrib/postgres/operations.py#L310"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.contrib.postgres.operations.ValidateConstraint" title="Link to this definition">¶</a></dt>
<dd><p>Scans through the table and validates the given check constraint on
existing rows.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">AddConstraintNotValid</span></code> and <code class="docutils literal notranslate"><span class="pre">ValidateConstraint</span></code> operations should be
performed in two separate migrations. Performing both operations in the
same atomic migration has the same effect as
<a class="reference internal" href="../../../migration-operations/#django.db.migrations.operations.AddConstraint" title="django.db.migrations.operations.AddConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">AddConstraint</span></code></a>, whereas performing
them in a single non-atomic migration, may leave your database in an
inconsistent state if the <code class="docutils literal notranslate"><span class="pre">ValidateConstraint</span></code> operation fails.</p>
</div>
</section>
</section>

    </article>
  

  
    <nav class="browse-horizontal" aria-labelledby="browse-horizontal-header">
      <span id="browse-horizontal-header" class="visuallyhidden">Previous page and next page</span>
      
        <div class="left"><a rel="prev" href="../lookups/"><i class="icon icon-chevron-left"></i> PostgreSQL specific lookups</a></div>
      
      
        <div class="right"><a rel="next" href="../search/">Full text search <i class="icon icon-chevron-right"></i></a></div>
      
    </nav>
  


        <a href="#top" class="backtotop"><i class="icon icon-chevron-up"></i> Back to Top</a>
      </main>

      
  <div role="complementary">
    <h2 class="visuallyhidden" id="aside-header">Additional Information</h2>

    


  <div class="fundraising-sidebar">
    <h3>Support Django!</h3>

    <div class="small-heart">
      <img src="https://static.djangoproject.com/img/fundraising-heart.cd6bb84ffd33.svg" alt="Support Django!" />
    </div>

    <div class="small-cta">
      <ul class="list-links-small">
        <li><a href="https://www.djangoproject.com/fundraising/">
          inkatlas.com donated to the Django Software Foundation to support Django development. Donate today!
        </a></li>
      </ul>
    </div>
  </div>



    
      <h3>Contents</h3>
      
        <ul>
<li><a class="reference internal" href="#">Database migration operations</a><ul>
<li><a class="reference internal" href="#creating-extension-using-migrations">Creating extension using migrations</a></li>
<li><a class="reference internal" href="#createextension"><code class="docutils literal notranslate"><span class="pre">CreateExtension</span></code></a></li>
<li><a class="reference internal" href="#bloomextension"><code class="docutils literal notranslate"><span class="pre">BloomExtension</span></code></a></li>
<li><a class="reference internal" href="#btreeginextension"><code class="docutils literal notranslate"><span class="pre">BtreeGinExtension</span></code></a></li>
<li><a class="reference internal" href="#btreegistextension"><code class="docutils literal notranslate"><span class="pre">BtreeGistExtension</span></code></a></li>
<li><a class="reference internal" href="#citextextension"><code class="docutils literal notranslate"><span class="pre">CITextExtension</span></code></a></li>
<li><a class="reference internal" href="#cryptoextension"><code class="docutils literal notranslate"><span class="pre">CryptoExtension</span></code></a></li>
<li><a class="reference internal" href="#hstoreextension"><code class="docutils literal notranslate"><span class="pre">HStoreExtension</span></code></a></li>
<li><a class="reference internal" href="#trigramextension"><code class="docutils literal notranslate"><span class="pre">TrigramExtension</span></code></a></li>
<li><a class="reference internal" href="#unaccentextension"><code class="docutils literal notranslate"><span class="pre">UnaccentExtension</span></code></a></li>
<li><a class="reference internal" href="#managing-collations-using-migrations">Managing collations using migrations</a></li>
<li><a class="reference internal" href="#concurrent-index-operations">Concurrent index operations</a></li>
<li><a class="reference internal" href="#adding-constraints-without-enforcing-validation">Adding constraints without enforcing validation</a></li>
</ul>
</li>
</ul>

      
    

    
      <nav aria-labelledby="browse-header">
        <h3 id="browse-header">Browse</h3>
        <ul>
          
            
              <li>Prev: <a rel="prev" href="../lookups/">PostgreSQL specific lookups</a></li>
            
            
              <li>Next: <a rel="next" href="../search/">Full text search</a></li>
            
            <li><a href="https://docs.djangoproject.com/en/6.0/contents/">Table of contents</a></li>
            
              <li><a href="https://docs.djangoproject.com/en/6.0/genindex/">General Index</a></li>
            
              <li><a href="https://docs.djangoproject.com/en/6.0/py-modindex/">Python Module Index</a></li>
            
          
        </ul>
      </nav>
    

    
      <nav aria-labelledby="breadcrumbs-header">
        <h3 id="breadcrumbs-header">You are here:</h3>
        <ul>
          <li>
            <a href="https://docs.djangoproject.com/en/6.0/">Django 6.0 documentation</a>
            
              <ul><li><a href="../../../">API Reference</a>
            
              <ul><li><a href="../../"><code class="docutils literal notranslate"><span class="pre">contrib</span></code> packages</a>
            
              <ul><li><a href="../"><code class="docutils literal notranslate"><span class="pre">django.contrib.postgres</span></code></a>
            
            <ul><li>Database migration operations</li></ul>
            </li></ul></li></ul></li></ul>
          </li>
        </ul>
      </nav>
    

    
      <section aria-labelledby="getting-help-sidebar">
        <h3 id="getting-help-sidebar">Getting help</h3>
        <dl class="list-links">
          <dt><a href="https://docs.djangoproject.com/en/6.0/faq/">FAQ</a></dt>
          <dd>Try the FAQ — it's got answers to many common questions.</dd>

          <dt><a href="/en/stable/genindex/">Index</a>, <a href="/en/stable/py-modindex/">Module Index</a>, or <a href="/en/stable/contents/">Table of Contents</a></dt>
          <dd>Handy when looking for specific information.</dd>

          <dt><a href="https://chat.djangoproject.com">Django Discord Server</a></dt>
          <dd>Join the Django Discord Community.</dd>

          <dt><a href="https://forum.djangoproject.com/">Official Django Forum</a></dt>
          <dd>Join the community on the Django Forum.</dd>

          <dt><a href="https://code.djangoproject.com/">Ticket tracker</a></dt>
          <dd>Report bugs with Django or Django documentation in our ticket tracker.</dd>
        </dl>
      </section>
    

    
      <section aria-labelledby="links-wrapper-header">
        <h3 id="links-wrapper-header">Download:</h3>
        <p>
          Offline (Django 6.0):
          <a href="https://media.djangoproject.com/docs/django-docs-6.0-en.zip">HTML</a> |
          <a href="https://media.readthedocs.org/pdf/django/6.0.x/django.pdf">PDF</a> |
          <a href="https://media.readthedocs.org/epub/django/6.0.x/django.epub">ePub</a>
          <br>
          <span class="quiet">
            Provided by <a href="https://readthedocs.org/">Read the Docs</a>.
          </span>
        </p>
      </section>
    

    
  <div class="corporate-members">
    <h3>Diamond and Platinum Members</h3>
    
      <div class="clearfix">
        <div class="member-logo">
          <a href="https://sentry.io/for/django/" title="Sentry">
            <img src="https://media.djangoproject.com/cache/7a/f9/7af9c770dc49465739a82c91a0eb3d51.png" alt="Sentry" />
          </a>
        </div>
        <div class="small-cta">
          <ul class="list-links-small">
            <li><strong>Sentry</strong></li>
            <li><a href="https://sentry.io/for/django/" title="Sentry">
              Monitor your Django Code
Resolve performance bottlenecks and errors using monitoring, replays, logs and Seer an AI agent for debugging.
            </a></li>
          </ul>
        </div>
      </div>
    
      <div class="clearfix">
        <div class="member-logo">
          <a href="https://jb.gg/ybja10" title="JetBrains">
            <img src="https://media.djangoproject.com/cache/c0/ea/c0ea128467983e64aab91cd27e7918c0.png" alt="JetBrains" />
          </a>
        </div>
        <div class="small-cta">
          <ul class="list-links-small">
            <li><strong>JetBrains</strong></li>
            <li><a href="https://jb.gg/ybja10" title="JetBrains">
              JetBrains delivers intelligent software solutions that make developers more productive by simplifying their challenging tasks, automating the routine, and helping them adopt the best development practices. PyCharm is the Python IDE for Professional Developers by JetBrains providing a complete set of tools for productive Python, Web and scientific development.
            </a></li>
          </ul>
        </div>
      </div>
    
  </div>


  </div>

      

    </div>

     
     

    
    
    

    <!-- SVGs -->
    <svg xmlns="http://www.w3.org/2000/svg">
      <symbol viewBox="0 0 24 24" id="icon-auto"><path d="M0 0h24v24H0z" fill="currentColor"/><path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2V4a8 8 0 1 0 0 16z"/></symbol>
      <symbol viewBox="0 0 24 24" id="icon-moon"><path d="M0 0h24v24H0z" fill="currentColor"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol>
      <symbol viewBox="0 0 24 24" id="icon-sun"><path d="M0 0h24v24H0z" fill="currentColor"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol>
    </svg>
    <!-- END SVGs -->

    
      

<footer>
  <div class="subfooter">
    <div class="container">
      <h2 class="visuallyhidden">Django Links</h2>
      <div class="column-container">
        <div class="col-learn-more">
          <h3>Learn More</h3>
          <ul>
            <li><a href="https://www.djangoproject.com/start/overview/">About Django</a></li>
            
            <li><a href="https://www.djangoproject.com/start/">Getting Started with Django</a></li>
            <li><a href="https://www.djangoproject.com/foundation/teams/">Team Organization</a></li>
            <li><a href="https://www.djangoproject.com/foundation/">Django Software Foundation</a></li>
            <li><a href="https://www.djangoproject.com/conduct/">Code of Conduct</a></li>
            <li><a href="https://www.djangoproject.com/diversity/">Diversity Statement</a></li>
          </ul>
        </div>

        <div class="col-get-involved">
          <h3>Get Involved</h3>
          <ul>
            <li><a href="https://www.djangoproject.com/community/">Join a Group</a></li>
            <li><a href="https://docs.djangoproject.com/en/dev/internals/contributing/">Contribute
              to Django</a></li>
            <li><a
              href="https://docs.djangoproject.com/en/dev/internals/contributing/bugs-and-features/">Submit
              a Bug</a></li>
            <li><a
              href="https://docs.djangoproject.com/en/dev/internals/security/#reporting-security-issues">Report
              a Security Issue</a></li>
            <li><a href="https://www.djangoproject.com/foundation/individual-members/">Individual membership</a></li>
          </ul>
        </div>

        <div class="col-get-help">
          <h3>Get Help</h3>
          <ul>
            <li><a href="https://docs.djangoproject.com/en/stable/faq/">Getting Help FAQ</a>
            </li>
            <li><a href="https://chat.djangoproject.com" target="_blank">Django Discord</a></li>
            <li><a href="https://forum.djangoproject.com/" target="_blank">Official Django Forum</a></li>
          </ul>
        </div>

        <div class="col-follow-us">
          <h3>Follow Us</h3>
          <ul>
            <li><a href="https://github.com/django">GitHub</a></li>
            <li><a href="https://x.com/djangoproject">X</a></li>
            <li><a href="https://fosstodon.org/@django" rel="me">Fediverse (Mastodon)</a></li>
            <li><a href="https://bsky.app/profile/djangoproject.com">Bluesky</a></li>
            <li><a href="https://www.linkedin.com/company/django-software-foundation">LinkedIn</a></li>
            <li><a href="https://www.djangoproject.com/rss/weblog/">News RSS</a></li>
          </ul>
        </div>

        <div class="col-support-us">
          <h3>Support Us</h3>
          <ul>
            <li><a href="https://www.djangoproject.com/fundraising/">Sponsor Django</a></li>
            <li><a href="https://www.djangoproject.com/foundation/corporate-membership/">Corporate membership</a></li>
            <li><a href="https://django.threadless.com/" target="_blank">Official merchandise store</a></li>
            <li><a href="https://www.djangoproject.com/foundation/donate/#benevity-giving">Benevity Workplace Giving Program</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <div class="container">
      <div class="footer-logo">
        <a class="logo" href="https://www.djangoproject.com/">Django</a>
      </div>
      <ul class="thanks">
        <li>
          <span>Hosting by</span> <a class="in-kind-donors" href="https://www.djangoproject.com/fundraising/#in-kind-donors">In-kind
            donors</a>
        </li>
        <li class="design"><span>Design by</span> <a class="threespot" href="https://www.threespot.com">Threespot</a>
          <span class="ampersand">&amp;</span> <a class="andrevv" href="http://andrevv.com/">andrevv</a></li>
      </ul>
      <p class="copyright">&copy; 2005-2025
        <a href="https://www.djangoproject.com/foundation/"> Django Software
          Foundation</a> and individual contributors. Django is a
        <a href="https://www.djangoproject.com/trademarks/">registered
          trademark</a> of the Django Software Foundation.
      </p>
    </div>
  </div>

</footer>

    

    
  


    
      
      <script>
        function extless(input) {
          return input.replace(/(.*)\.[^.]+$/, '$1');
        }
        var require = {
          shim: {
            'jquery': [],
            'stripe': {
              exports: 'Stripe'
            }
          },
          paths: {
            "jquery": extless("https://static.djangoproject.com/js/lib/jquery.min.5790ead7ad3b.js"),
            "mod/list-collapsing": extless("https://static.djangoproject.com/js/mod/list-collapsing.2d844151b2ec.js"),
            "mod/stripe-change-card": extless("https://static.djangoproject.com/js/mod/stripe-change-card.eaa0afc324e9.js"),
            "mod/switch-dark-mode": extless("https://static.djangoproject.com/js/mod/switch-dark-mode.139625c684db.js"),
            "stripe-checkout": "https://checkout.stripe.com/checkout",
            "stripe": "https://js.stripe.com/v3/?" // ? needed due to require.js
          }
        };
      </script>
      <script data-main="https://static.djangoproject.com/js/main.8677b21133eb.js" src="https://static.djangoproject.com/js/lib/require.177879fbe7dd.js"></script>
      <script src="https://static.djangoproject.com/js/djangoproject.15c016c8c3a7.js"></script>
    
  </body>
</html>
