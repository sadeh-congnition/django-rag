<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="ROBOTS" content="ALL" />
    <meta name="MSSmartTagsPreventParsing" content="true" />
    <meta name="Copyright" content="Django Software Foundation" />
    <meta name="keywords" content="Python, Django, framework, open-source" />
    <meta name="description" content="" />
    <meta name="fediverse:creator" content="@django@fosstodon.org" />
    
  
    
      
    
  
  <link rel="canonical" href="https://docs.djangoproject.com/en/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="el"
          href="https://docs.djangoproject.com/el/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="en"
          href="https://docs.djangoproject.com/en/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="es"
          href="https://docs.djangoproject.com/es/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="fr"
          href="https://docs.djangoproject.com/fr/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="id"
          href="https://docs.djangoproject.com/id/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="it"
          href="https://docs.djangoproject.com/it/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="ja"
          href="https://docs.djangoproject.com/ja/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="ko"
          href="https://docs.djangoproject.com/ko/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="pl"
          href="https://docs.djangoproject.com/pl/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="pt-br"
          href="https://docs.djangoproject.com/pt-br/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="sv"
          href="https://docs.djangoproject.com/sv/6.0/topics/testing/advanced/">
  
    
      
    
    <link rel="alternate"
          hreflang="zh-hans"
          href="https://docs.djangoproject.com/zh-hans/6.0/topics/testing/advanced/">
  

  <link rel="search"
        type="application/opensearchdescription+xml"
        href="https://docs.djangoproject.com/en/6.0/search/description/"
        title="Django documentation">

    <!-- Favicons -->
    <link rel="apple-touch-icon" href="https://static.djangoproject.com/img/icon-touch.e4872c4da341.png">
    <link rel="icon" sizes="192x192" href="https://static.djangoproject.com/img/icon-touch.e4872c4da341.png">
    <link rel="shortcut icon" href="https://static.djangoproject.com/img/favicon.6dbf28c0650e.ico">
    <meta name="msapplication-TileColor" content="#113228">
    <meta name="msapplication-TileImage" content="https://static.djangoproject.com/img/icon-tile.b01ac0ef9f67.png">
    <meta name="theme-color" content="#0C4B33">

    
      <meta property="og:title" content="Advanced testing topics | Django documentation" />
      <meta property="og:description" content="The web framework for perfectionists with deadlines." />
      <meta property="og:image" content="https://static.djangoproject.com/img/logos/django-logo-negative.1d528e2cb5fb.png" />
      <meta property="og:image:alt" content="Django logo" />
      <meta property="og:image:width" content="1200" />
      <meta property="og:image:height" content="546" />
      <meta property="og:image:type" content="image/png"/>
      <meta property="og:url" content="https://docs.djangoproject.com/en/6.0/topics/testing/advanced/" />
      <meta property="og:site_name" content="Django Project" />

      <meta property="twitter:creator" content="djangoproject" />
      <meta property="twitter:site" content="djangoproject" />
      <meta property="twitter:card" content="summary">
    

    <title>Advanced testing topics | Django documentation | Django</title>

    <link rel="stylesheet" href="https://static.djangoproject.com/css/output.7f12b704d16e.css" >

    <script src="https://static.djangoproject.com/js/mod/switch-dark-mode.139625c684db.js"></script>
    
  </head>

  <body id="generic" class="">

    <a href="#main-content" class="skip-link">Skip to main content</a>
    

<header id="top">
  <div class="container container--flex--wrap--mobile">
    <a class="logo" href="https://www.djangoproject.com/">Django</a>
    <p class="meta">The web framework for perfectionists with deadlines.</p>
    <div class="header-mobile-only">
      
<search class="search form-input" aria-labelledby="docs-search-label">
  <form action="https://docs.djangoproject.com/en/6.0/search/">
    <label id="docs-search-label" class="visuallyhidden" for="id_q">Search</label>
    <input type="search" name="q" placeholder="Search" id="id_q">
    <input type="hidden" name="category" value="">

    <button type="submit">
      <i class="icon icon-search" aria-hidden="true"></i>
      <span class="visuallyhidden">Submit</span>
    </button>
  </form>
</search>

      <div class="light-dark-mode-toggle">
        

<button class="theme-toggle">
  <div class="visually-hidden theme-label-when-auto">Toggle theme (current theme: auto)</div>
  <div class="visually-hidden theme-label-when-light">Toggle theme (current theme: light)</div>
  <div class="visually-hidden theme-label-when-dark">Toggle theme (current theme: dark)</div>

  <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
  <svg aria-hidden="true" class="theme-icon-when-auto">
    <use xlink:href="#icon-auto" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-dark">
    <use xlink:href="#icon-moon" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-light">
    <use xlink:href="#icon-sun" />
  </svg>
</button>

      </div>
    </div>
    <button class="menu-button">
      <i class="icon icon-reorder"></i>
      <span class="visuallyhidden">Menu</span>
    </button>
    <nav aria-labelledby="navigation-header">
      <span id="navigation-header" class="visuallyhidden">Main navigation</span>
      <ul>
        <li>
          <a href="https://www.djangoproject.com/start/overview/">Overview</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/download/">Download</a>
        </li>
        <li class="active">
          <a href="https://docs.djangoproject.com/">Documentation</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/weblog/">News</a>
        </li>
        <li>
          <a href="https://github.com/django/django" target="_blank" rel="noopener">Code</a>
        </li>
        <li>
          <a href="https://code.djangoproject.com/">Issues</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/community/">Community</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/foundation/">Foundation</a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/fundraising/">&#9829; Donate</a>
        </li>
        <li>
          
<search class="search form-input" aria-labelledby="docs-search-label">
  <form action="https://docs.djangoproject.com/en/6.0/search/">
    <label id="docs-search-label" class="visuallyhidden" for="id_q">Search</label>
    <input type="search" name="q" placeholder="Search" id="id_q">
    <input type="hidden" name="category" value="">

    <button type="submit">
      <i class="icon icon-search" aria-hidden="true"></i>
      <span class="visuallyhidden">Submit</span>
    </button>
  </form>
</search>

        </li>
        <li>
          

<button class="theme-toggle">
  <div class="visually-hidden theme-label-when-auto">Toggle theme (current theme: auto)</div>
  <div class="visually-hidden theme-label-when-light">Toggle theme (current theme: light)</div>
  <div class="visually-hidden theme-label-when-dark">Toggle theme (current theme: dark)</div>

  <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
  <svg aria-hidden="true" class="theme-icon-when-auto">
    <use xlink:href="#icon-auto" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-dark">
    <use xlink:href="#icon-moon" />
  </svg>
  <svg aria-hidden="true" class="theme-icon-when-light">
    <use xlink:href="#icon-sun" />
  </svg>
</button>

        </li>
      </ul>
    </nav>
  </div>
</header>

    

    <section class="copy-banner">
      <div class="container 
  container--flex container--flex--wrap--mobile
">
        
  <p><a href="https://docs.djangoproject.com/en/6.0/">Documentation</a></p>

      </div>
    </section>

    <div id="billboard">
      
    </div>

    <div class="container sidebar-right">
      <main id="main-content">

        
          
        

        
  <div id="version-switcher">
    <ul id="faq-link">
      <li class="current-link">
        <a href="https://docs.djangoproject.com/en/6.0/faq/help/">
          <span>Getting Help</span>
        </a>
      </li>
    </ul>
    <ul id="doc-languages" class="language-switcher doc-switcher">
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/el/6.0/topics/testing/advanced/">el</a>
          </li>
        
      
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/es/6.0/topics/testing/advanced/">es</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/fr/6.0/topics/testing/advanced/">fr</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/id/6.0/topics/testing/advanced/">id</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/it/6.0/topics/testing/advanced/">it</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/ja/6.0/topics/testing/advanced/">ja</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/ko/6.0/topics/testing/advanced/">ko</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/pl/6.0/topics/testing/advanced/">pl</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/pt-br/6.0/topics/testing/advanced/">pt-br</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/sv/6.0/topics/testing/advanced/">sv</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/zh-hans/6.0/topics/testing/advanced/">zh-hans</a>
          </li>
        
      
      <li class="current"
          title="Click on the links on the left to switch to another language.">
        <span>Language: <strong>en</strong></span>
      </li>
    </ul>

    
    <ul id="doc-versions" class="version-switcher doc-switcher">
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/1.8/topics/testing/advanced/">1.8</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/1.10/topics/testing/advanced/">1.10</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/1.11/topics/testing/advanced/">1.11</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/2.0/topics/testing/advanced/">2.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/2.1/topics/testing/advanced/">2.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/2.2/topics/testing/advanced/">2.2</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/3.0/topics/testing/advanced/">3.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/3.1/topics/testing/advanced/">3.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/3.2/topics/testing/advanced/">3.2</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/4.0/topics/testing/advanced/">4.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/4.1/topics/testing/advanced/">4.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/4.2/topics/testing/advanced/">4.2</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/5.0/topics/testing/advanced/">5.0</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/5.1/topics/testing/advanced/">5.1</a>
          </li>
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/5.2/topics/testing/advanced/">5.2</a>
          </li>
        
      
        
      
        
          <li class="other">
            
              
            
            <a href="https://docs.djangoproject.com/en/dev/topics/testing/advanced/">dev</a>
          </li>
        
      
      <li class="current"
          title="This document describes Django 6.0. Click on the links on the left to see other versions.">
        <span>Documentation version:
          <strong>6.0</strong>
        </span>
      </li>
    </ul>
    <ul id="backtotop-link">
      <li class="current-link">
        <a href="#top" aria-label="Back to top" class="icon-chevron-up-align"><i class="icon icon-chevron-up"></i></a>
      </li>
    </ul>
  </div>

  
    <article id="docs-content">
      <section id="s-advanced-testing-topics">
<span id="advanced-testing-topics"></span><h1>Advanced testing topics<a class="headerlink" href="#advanced-testing-topics" title="Link to this heading">¶</a></h1>
<section id="s-the-request-factory">
<span id="the-request-factory"></span><h2>The request factory<a class="headerlink" href="#the-request-factory" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="django.test.RequestFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RequestFactory</span></span><a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/client.py#L370"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.RequestFactory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p>The <a class="reference internal" href="#django.test.RequestFactory" title="django.test.RequestFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestFactory</span></code></a> shares the same API as
the test client. However, instead of behaving like a browser, the
RequestFactory provides a way to generate a request instance that can
be used as the first argument to any view. This means you can test a
view function the same way as you would test any other function – as
a black box, with exactly known inputs, testing for specific outputs.</p>
<p>The API for the <a class="reference internal" href="#django.test.RequestFactory" title="django.test.RequestFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestFactory</span></code></a> is a slightly
restricted subset of the test client API:</p>
<ul class="simple">
<li><p>It only has access to the HTTP methods <a class="reference internal" href="../tools/#django.test.Client.get" title="django.test.Client.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a>,
<a class="reference internal" href="../tools/#django.test.Client.post" title="django.test.Client.post"><code class="xref py py-meth docutils literal notranslate"><span class="pre">post()</span></code></a>, <a class="reference internal" href="../tools/#django.test.Client.put" title="django.test.Client.put"><code class="xref py py-meth docutils literal notranslate"><span class="pre">put()</span></code></a>,
<a class="reference internal" href="../tools/#django.test.Client.delete" title="django.test.Client.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete()</span></code></a>, <a class="reference internal" href="../tools/#django.test.Client.head" title="django.test.Client.head"><code class="xref py py-meth docutils literal notranslate"><span class="pre">head()</span></code></a>,
<a class="reference internal" href="../tools/#django.test.Client.options" title="django.test.Client.options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">options()</span></code></a>, and <a class="reference internal" href="../tools/#django.test.Client.trace" title="django.test.Client.trace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trace()</span></code></a>.</p></li>
<li><p>These methods accept all the same arguments <em>except</em> for
<code class="docutils literal notranslate"><span class="pre">follow</span></code>. Since this is just a factory for producing
requests, it’s up to you to handle the response.</p></li>
<li><p>It does not support middleware. Session and authentication
attributes must be supplied by the test itself if required
for the view to function properly.</p></li>
</ul>
<section id="s-example">
<span id="example"></span><h3>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h3>
<p>The following is a unit test using the request factory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnonymousUser</span><span class="p">,</span> <span class="n">User</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">RequestFactory</span><span class="p">,</span> <span class="n">TestCase</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyView</span><span class="p">,</span> <span class="n">my_view</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SimpleTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Every test needs access to the request factory.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">RequestFactory</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;jacob&quot;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="s2">&quot;jacob@…&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;top_secret&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create an instance of a GET request.</span>
        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/customer/details&quot;</span><span class="p">)</span>

        <span class="c1"># Recall that middleware are not supported. You can simulate a</span>
        <span class="c1"># logged-in user by setting request.user manually.</span>
        <span class="n">request</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span>

        <span class="c1"># Or you can simulate an anonymous user by setting request.user to</span>
        <span class="c1"># an AnonymousUser instance.</span>
        <span class="n">request</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">AnonymousUser</span><span class="p">()</span>

        <span class="c1"># Test my_view() as if it were deployed at /customer/details</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="c1"># Use this syntax for class-based views.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">MyView</span><span class="o">.</span><span class="n">as_view</span><span class="p">()(</span><span class="n">request</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="s-asyncrequestfactory">
<span id="asyncrequestfactory"></span><h3>AsyncRequestFactory<a class="headerlink" href="#asyncrequestfactory" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="django.test.AsyncRequestFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AsyncRequestFactory</span></span><a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/client.py#L674"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.AsyncRequestFactory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">RequestFactory</span></code> creates WSGI-like requests. If you want to create ASGI-like
requests, including having a correct ASGI <code class="docutils literal notranslate"><span class="pre">scope</span></code>, you can instead use
<code class="docutils literal notranslate"><span class="pre">django.test.AsyncRequestFactory</span></code>.</p>
<p>This class is directly API-compatible with <code class="docutils literal notranslate"><span class="pre">RequestFactory</span></code>, with the only
difference being that it returns <code class="docutils literal notranslate"><span class="pre">ASGIRequest</span></code> instances rather than
<code class="docutils literal notranslate"><span class="pre">WSGIRequest</span></code> instances. All of its methods are still synchronous callables.</p>
<p>Arbitrary keyword arguments in <code class="docutils literal notranslate"><span class="pre">defaults</span></code> are added directly into the ASGI
scope.</p>
</section>
</section>
<section id="s-testing-class-based-views">
<span id="testing-class-based-views"></span><h2>Testing class-based views<a class="headerlink" href="#testing-class-based-views" title="Link to this heading">¶</a></h2>
<p>In order to test class-based views outside of the request/response cycle you
must ensure that they are configured correctly, by calling
<a class="reference internal" href="../../../ref/class-based-views/base/#django.views.generic.base.View.setup" title="django.views.generic.base.View.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup()</span></code></a> after instantiation.</p>
<p>For example, assuming the following class-based view:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">views.py</span></code></span><a class="headerlink" href="#id1" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.views.generic</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemplateView</span>


<span class="k">class</span><span class="w"> </span><span class="nc">HomeView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s2">&quot;myapp/home.html&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Production&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You may directly test the <code class="docutils literal notranslate"><span class="pre">get_context_data()</span></code> method by first instantiating
the view, then passing a <code class="docutils literal notranslate"><span class="pre">request</span></code> to <code class="docutils literal notranslate"><span class="pre">setup()</span></code>, before proceeding with
your test’s code:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">tests.py</span></code></span><a class="headerlink" href="#id2" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">RequestFactory</span><span class="p">,</span> <span class="n">TestCase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">HomeView</span>


<span class="k">class</span><span class="w"> </span><span class="nc">HomePageTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_environment_set_in_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">RequestFactory</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">view</span> <span class="o">=</span> <span class="n">HomeView</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

        <span class="n">context</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="s-tests-and-multiple-host-names">
<span id="s-topics-testing-advanced-multiple-hosts"></span><span id="tests-and-multiple-host-names"></span><span id="topics-testing-advanced-multiple-hosts"></span><h2>Tests and multiple host names<a class="headerlink" href="#tests-and-multiple-host-names" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../../ref/settings/#std-setting-ALLOWED_HOSTS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">ALLOWED_HOSTS</span></code></a> setting is validated when running tests. This
allows the test client to differentiate between internal and external URLs.</p>
<p>Projects that support multitenancy or otherwise alter business logic based on
the request’s host and use custom host names in tests must include those hosts
in <a class="reference internal" href="../../../ref/settings/#std-setting-ALLOWED_HOSTS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">ALLOWED_HOSTS</span></code></a>.</p>
<p>The first option to do so is to add the hosts to your settings file. For
example, the test suite for docs.djangoproject.com includes the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SearchFormTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_empty_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;/en/dev/search/&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;docs.djangoproject.dev:8000&quot;</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p>and the settings file includes a list of the domains supported by the project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;www.djangoproject.dev&quot;</span><span class="p">,</span> <span class="s2">&quot;docs.djangoproject.dev&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Another option is to add the required hosts to <a class="reference internal" href="../../../ref/settings/#std-setting-ALLOWED_HOSTS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">ALLOWED_HOSTS</span></code></a> using
<a class="reference internal" href="../tools/#django.test.override_settings" title="django.test.override_settings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">override_settings()</span></code></a> or
<a class="reference internal" href="../tools/#django.test.SimpleTestCase.modify_settings" title="django.test.SimpleTestCase.modify_settings"><code class="xref py py-attr docutils literal notranslate"><span class="pre">modify_settings</span></code></a>. This option may be
preferable in standalone apps that can’t package their own settings file or
for projects where the list of domains is not static (e.g., subdomains for
multitenancy). For example, you could write a test for the domain
<code class="docutils literal notranslate"><span class="pre">http://otherserver/</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">override_settings</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MultiDomainTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="nd">@override_settings</span><span class="p">(</span><span class="n">ALLOWED_HOSTS</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;otherserver&quot;</span><span class="p">])</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_other_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://otherserver/foo/bar/&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Disabling <a class="reference internal" href="../../../ref/settings/#std-setting-ALLOWED_HOSTS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">ALLOWED_HOSTS</span></code></a> checking (<code class="docutils literal notranslate"><span class="pre">ALLOWED_HOSTS</span> <span class="pre">=</span> <span class="pre">['*']</span></code>) when
running tests prevents the test client from raising a helpful error message if
you follow a redirect to an external URL.</p>
</section>
<section id="s-tests-and-multiple-databases">
<span id="s-topics-testing-advanced-multidb"></span><span id="tests-and-multiple-databases"></span><span id="topics-testing-advanced-multidb"></span><h2>Tests and multiple databases<a class="headerlink" href="#tests-and-multiple-databases" title="Link to this heading">¶</a></h2>
<section id="s-testing-primary-replica-configurations">
<span id="s-topics-testing-primaryreplica"></span><span id="testing-primary-replica-configurations"></span><span id="topics-testing-primaryreplica"></span><h3>Testing primary/replica configurations<a class="headerlink" href="#testing-primary-replica-configurations" title="Link to this heading">¶</a></h3>
<p>If you’re testing a multiple database configuration with primary/replica
(referred to as master/slave by some databases) replication, this strategy of
creating test databases poses a problem.
When the test databases are created, there won’t be any replication,
and as a result, data created on the primary won’t be seen on the
replica.</p>
<p>To compensate for this, Django allows you to define that a database is
a <em>test mirror</em>. Consider the following (simplified) example database
configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ENGINE&quot;</span><span class="p">:</span> <span class="s2">&quot;django.db.backends.mysql&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NAME&quot;</span><span class="p">:</span> <span class="s2">&quot;myproject&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HOST&quot;</span><span class="p">:</span> <span class="s2">&quot;dbprimary&quot;</span><span class="p">,</span>
        <span class="c1"># ... plus some other settings</span>
    <span class="p">},</span>
    <span class="s2">&quot;replica&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;ENGINE&quot;</span><span class="p">:</span> <span class="s2">&quot;django.db.backends.mysql&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NAME&quot;</span><span class="p">:</span> <span class="s2">&quot;myproject&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HOST&quot;</span><span class="p">:</span> <span class="s2">&quot;dbreplica&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TEST&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;MIRROR&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="c1"># ... plus some other settings</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this setup, we have two database servers: <code class="docutils literal notranslate"><span class="pre">dbprimary</span></code>, described
by the database alias <code class="docutils literal notranslate"><span class="pre">default</span></code>, and <code class="docutils literal notranslate"><span class="pre">dbreplica</span></code> described by the
alias <code class="docutils literal notranslate"><span class="pre">replica</span></code>. As you might expect, <code class="docutils literal notranslate"><span class="pre">dbreplica</span></code> has been configured
by the database administrator as a read replica of <code class="docutils literal notranslate"><span class="pre">dbprimary</span></code>, so in
normal activity, any write to <code class="docutils literal notranslate"><span class="pre">default</span></code> will appear on <code class="docutils literal notranslate"><span class="pre">replica</span></code>.</p>
<p>If Django created two independent test databases, this would break any
tests that expected replication to occur. However, the <code class="docutils literal notranslate"><span class="pre">replica</span></code>
database has been configured as a test mirror (using the
<a class="reference internal" href="../../../ref/settings/#std-setting-TEST_MIRROR"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MIRROR</span></code></a> test setting), indicating that under
testing, <code class="docutils literal notranslate"><span class="pre">replica</span></code> should be treated as a mirror of <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
<p>When the test environment is configured, a test version of <code class="docutils literal notranslate"><span class="pre">replica</span></code>
will <em>not</em> be created. Instead the connection to <code class="docutils literal notranslate"><span class="pre">replica</span></code>
will be redirected to point at <code class="docutils literal notranslate"><span class="pre">default</span></code>. As a result, writes to
<code class="docutils literal notranslate"><span class="pre">default</span></code> will appear on <code class="docutils literal notranslate"><span class="pre">replica</span></code> – but because they are actually
the same database, not because there is data replication between the
two databases. As this depends on transactions, the tests must use
<a class="reference internal" href="../tools/#django.test.TransactionTestCase" title="django.test.TransactionTestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransactionTestCase</span></code></a> instead of
<a class="reference internal" href="../tools/#django.test.TestCase" title="django.test.TestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestCase</span></code></a>.</p>
</section>
<section id="s-controlling-creation-order-for-test-databases">
<span id="s-topics-testing-creation-dependencies"></span><span id="controlling-creation-order-for-test-databases"></span><span id="topics-testing-creation-dependencies"></span><h3>Controlling creation order for test databases<a class="headerlink" href="#controlling-creation-order-for-test-databases" title="Link to this heading">¶</a></h3>
<p>By default, Django will assume all databases depend on the <code class="docutils literal notranslate"><span class="pre">default</span></code>
database and therefore always create the <code class="docutils literal notranslate"><span class="pre">default</span></code> database first.
However, no guarantees are made on the creation order of any other
databases in your test setup.</p>
<p>If your database configuration requires a specific creation order, you
can specify the dependencies that exist using the <a class="reference internal" href="../../../ref/settings/#std-setting-TEST_DEPENDENCIES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DEPENDENCIES</span></code></a> test setting. Consider the following (simplified)
example database configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># ... db settings</span>
        <span class="s2">&quot;TEST&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;DEPENDENCIES&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;diamonds&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;diamonds&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># ... db settings</span>
        <span class="s2">&quot;TEST&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;DEPENDENCIES&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;clubs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># ... db settings</span>
        <span class="s2">&quot;TEST&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;DEPENDENCIES&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;diamonds&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;spades&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># ... db settings</span>
        <span class="s2">&quot;TEST&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;DEPENDENCIES&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;diamonds&quot;</span><span class="p">,</span> <span class="s2">&quot;hearts&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s2">&quot;hearts&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># ... db settings</span>
        <span class="s2">&quot;TEST&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;DEPENDENCIES&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;diamonds&quot;</span><span class="p">,</span> <span class="s2">&quot;clubs&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Under this configuration, the <code class="docutils literal notranslate"><span class="pre">diamonds</span></code> database will be created first,
as it is the only database alias without dependencies. The <code class="docutils literal notranslate"><span class="pre">default</span></code> and
<code class="docutils literal notranslate"><span class="pre">clubs</span></code> alias will be created next (although the order of creation of this
pair is not guaranteed), then <code class="docutils literal notranslate"><span class="pre">hearts</span></code>, and finally <code class="docutils literal notranslate"><span class="pre">spades</span></code>.</p>
<p>If there are any circular dependencies in the <a class="reference internal" href="../../../ref/settings/#std-setting-TEST_DEPENDENCIES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DEPENDENCIES</span></code></a> definition, an
<a class="reference internal" href="../../../ref/exceptions/#django.core.exceptions.ImproperlyConfigured" title="django.core.exceptions.ImproperlyConfigured"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ImproperlyConfigured</span></code></a> exception will be raised.</p>
</section>
</section>
<section id="s-advanced-features-of-transactiontestcase">
<span id="advanced-features-of-transactiontestcase"></span><h2>Advanced features of <code class="docutils literal notranslate"><span class="pre">TransactionTestCase</span></code><a class="headerlink" href="#advanced-features-of-transactiontestcase" title="Link to this heading">¶</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.test.TransactionTestCase.available_apps">
<span class="sig-prename descclassname"><span class="pre">TransactionTestCase.</span></span><span class="sig-name descname"><span class="pre">available_apps</span></span><a class="headerlink" href="#django.test.TransactionTestCase.available_apps" title="Link to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This attribute is a private API. It may be changed or removed without
a deprecation period in the future, for instance to accommodate changes
in application loading.</p>
<p>It’s used to optimize Django’s own test suite, which contains hundreds
of models but no relations between models in different applications.</p>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">available_apps</span></code> is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>. After each test, Django
calls <a class="reference internal" href="../../../ref/django-admin/#django-admin-flush"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">flush</span></code></a> to reset the database state. This empties all tables
and emits the <a class="reference internal" href="../../../ref/signals/#django.db.models.signals.post_migrate" title="django.db.models.signals.post_migrate"><code class="xref py py-data docutils literal notranslate"><span class="pre">post_migrate</span></code></a> signal, which
recreates one content type and four permissions for each model. This
operation gets expensive proportionally to the number of models.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">available_apps</span></code> to a list of applications instructs Django to
behave as if only the models from these applications were available. The
behavior of <code class="docutils literal notranslate"><span class="pre">TransactionTestCase</span></code> changes as follows:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../ref/signals/#django.db.models.signals.post_migrate" title="django.db.models.signals.post_migrate"><code class="xref py py-data docutils literal notranslate"><span class="pre">post_migrate</span></code></a> is fired before each
test to create the content types and permissions for each model in
available apps, in case they’re missing.</p></li>
<li><p>After each test, Django empties only tables corresponding to models in
available apps. However, at the database level, truncation may cascade to
related models in unavailable apps. Furthermore
<a class="reference internal" href="../../../ref/signals/#django.db.models.signals.post_migrate" title="django.db.models.signals.post_migrate"><code class="xref py py-data docutils literal notranslate"><span class="pre">post_migrate</span></code></a> isn’t fired; it will be
fired by the next <code class="docutils literal notranslate"><span class="pre">TransactionTestCase</span></code>, after the correct set of
applications is selected.</p></li>
</ul>
<p>Since the database isn’t fully flushed, if a test creates instances of
models not included in <code class="docutils literal notranslate"><span class="pre">available_apps</span></code>, they will leak and they may
cause unrelated tests to fail. Be careful with tests that use sessions;
the default session engine stores them in the database.</p>
<p>Since <a class="reference internal" href="../../../ref/signals/#django.db.models.signals.post_migrate" title="django.db.models.signals.post_migrate"><code class="xref py py-data docutils literal notranslate"><span class="pre">post_migrate</span></code></a> isn’t emitted after
flushing the database, its state after a <code class="docutils literal notranslate"><span class="pre">TransactionTestCase</span></code> isn’t the
same as after a <code class="docutils literal notranslate"><span class="pre">TestCase</span></code>: it’s missing the rows created by listeners
to <a class="reference internal" href="../../../ref/signals/#django.db.models.signals.post_migrate" title="django.db.models.signals.post_migrate"><code class="xref py py-data docutils literal notranslate"><span class="pre">post_migrate</span></code></a>. Considering the
<a class="reference internal" href="../overview/#order-of-tests"><span class="std std-ref">order in which tests are executed</span></a>, this isn’t an
issue, provided either all <code class="docutils literal notranslate"><span class="pre">TransactionTestCase</span></code> in a given test suite
declare <code class="docutils literal notranslate"><span class="pre">available_apps</span></code>, or none of them.</p>
<p><code class="docutils literal notranslate"><span class="pre">available_apps</span></code> is mandatory in Django’s own test suite.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="django.test.TransactionTestCase.reset_sequences">
<span class="sig-prename descclassname"><span class="pre">TransactionTestCase.</span></span><span class="sig-name descname"><span class="pre">reset_sequences</span></span><a class="headerlink" href="#django.test.TransactionTestCase.reset_sequences" title="Link to this definition">¶</a></dt>
<dd><p>Setting <code class="docutils literal notranslate"><span class="pre">reset_sequences</span> <span class="pre">=</span> <span class="pre">True</span></code> on a <code class="docutils literal notranslate"><span class="pre">TransactionTestCase</span></code> will make
sure sequences are always reset before the test run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestsThatDependsOnPrimaryKeySequences</span><span class="p">(</span><span class="n">TransactionTestCase</span><span class="p">):</span>
    <span class="n">reset_sequences</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_animal_pk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lion</span> <span class="o">=</span> <span class="n">Animal</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;lion&quot;</span><span class="p">,</span> <span class="n">sound</span><span class="o">=</span><span class="s2">&quot;roar&quot;</span><span class="p">)</span>
        <span class="c1"># lion.pk is guaranteed to always be 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">lion</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Unless you are explicitly testing primary keys sequence numbers, it is
recommended that you do not hardcode primary key values in tests.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">reset_sequences</span> <span class="pre">=</span> <span class="pre">True</span></code> will slow down the test, since the primary
key reset is a relatively expensive database operation.</p>
</dd></dl>

</section>
<section id="s-enforce-running-test-classes-sequentially">
<span id="s-topics-testing-enforce-run-sequentially"></span><span id="enforce-running-test-classes-sequentially"></span><span id="topics-testing-enforce-run-sequentially"></span><h2>Enforce running test classes sequentially<a class="headerlink" href="#enforce-running-test-classes-sequentially" title="Link to this heading">¶</a></h2>
<p>If you have test classes that cannot be run in parallel (e.g. because they
share a common resource), you can use <code class="docutils literal notranslate"><span class="pre">django.test.testcases.SerializeMixin</span></code>
to run them sequentially. This mixin uses a filesystem <code class="docutils literal notranslate"><span class="pre">lockfile</span></code>.</p>
<p>For example, you can use <code class="docutils literal notranslate"><span class="pre">__file__</span></code> to determine that all test classes in the
same file that inherit from <code class="docutils literal notranslate"><span class="pre">SerializeMixin</span></code> will run sequentially:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.test.testcases</span><span class="w"> </span><span class="kn">import</span> <span class="n">SerializeMixin</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ImageTestCaseMixin</span><span class="p">(</span><span class="n">SerializeMixin</span><span class="p">):</span>
    <span class="n">lockfile</span> <span class="o">=</span> <span class="vm">__file__</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_storage_dir</span><span class="p">,</span> <span class="s2">&quot;my_file.png&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">create_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">RemoveImageTests</span><span class="p">(</span><span class="n">ImageTestCaseMixin</span><span class="p">,</span> <span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_remove_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">))</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ResizeImageTests</span><span class="p">(</span><span class="n">ImageTestCaseMixin</span><span class="p">,</span> <span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_resize_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">resize_image</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_image_size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">),</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="s-using-the-django-test-runner-to-test-reusable-applications">
<span id="s-testing-reusable-applications"></span><span id="using-the-django-test-runner-to-test-reusable-applications"></span><span id="testing-reusable-applications"></span><h2>Using the Django test runner to test reusable applications<a class="headerlink" href="#using-the-django-test-runner-to-test-reusable-applications" title="Link to this heading">¶</a></h2>
<p>If you are writing a <a class="reference internal" href="../../../intro/reusable-apps/"><span class="doc">reusable application</span></a>
you may want to use the Django test runner to run your own test suite
and thus benefit from the Django testing infrastructure.</p>
<p>A common practice is a <em>tests</em> directory next to the application code, with the
following structure:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>runtests.py
polls/
    __init__.py
    models.py
    ...
tests/
    __init__.py
    models.py
    test_settings.py
    tests.py
</pre></div>
</div>
<p>Let’s take a look inside a couple of those files:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">runtests.py</span></code></span><a class="headerlink" href="#id3" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">django</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.test.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_runner</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;DJANGO_SETTINGS_MODULE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tests.test_settings&quot;</span>
    <span class="n">django</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
    <span class="n">TestRunner</span> <span class="o">=</span> <span class="n">get_runner</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
    <span class="n">test_runner</span> <span class="o">=</span> <span class="n">TestRunner</span><span class="p">()</span>
    <span class="n">failures</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run_tests</span><span class="p">([</span><span class="s2">&quot;tests&quot;</span><span class="p">])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">failures</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>This is the script that you invoke to run the test suite. It sets up the
Django environment, creates the test database and runs the tests.</p>
<p>For the sake of clarity, this example contains only the bare minimum
necessary to use the Django test runner. You may want to add
command-line options for controlling verbosity, passing in specific test
labels to run, etc.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">tests/test_settings.py</span></code></span><a class="headerlink" href="#id4" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s2">&quot;fake-key&quot;</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;tests&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>This file contains the <a class="reference internal" href="../../settings/"><span class="doc">Django settings</span></a>
required to run your app’s tests.</p>
<p>Again, this is a minimal example; your tests may require additional
settings to run.</p>
<p>Since the <em>tests</em> package is included in <a class="reference internal" href="../../../ref/settings/#std-setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a> when
running your tests, you can define test-only models in its <code class="docutils literal notranslate"><span class="pre">models.py</span></code>
file.</p>
</section>
<section id="s-using-different-testing-frameworks">
<span id="s-other-testing-frameworks"></span><span id="using-different-testing-frameworks"></span><span id="other-testing-frameworks"></span><h2>Using different testing frameworks<a class="headerlink" href="#using-different-testing-frameworks" title="Link to this heading">¶</a></h2>
<p>Clearly, <a class="reference external" href="https://docs.python.org/3/library/unittest.html#module-unittest" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> is not the only Python testing framework. While Django
doesn’t provide explicit support for alternative frameworks, it does provide a
way to invoke tests constructed for an alternative framework as if they were
normal Django tests.</p>
<p>When you run <code class="docutils literal notranslate"><span class="pre">./manage.py</span> <span class="pre">test</span></code>, Django looks at the <a class="reference internal" href="../../../ref/settings/#std-setting-TEST_RUNNER"><code class="xref std std-setting docutils literal notranslate"><span class="pre">TEST_RUNNER</span></code></a>
setting to determine what to do. By default, <a class="reference internal" href="../../../ref/settings/#std-setting-TEST_RUNNER"><code class="xref std std-setting docutils literal notranslate"><span class="pre">TEST_RUNNER</span></code></a> points to
<code class="docutils literal notranslate"><span class="pre">'django.test.runner.DiscoverRunner'</span></code>. This class defines the default Django
testing behavior. This behavior involves:</p>
<ol class="arabic simple">
<li><p>Performing global pre-test setup.</p></li>
<li><p>Looking for tests in any file below the current directory whose name matches
the pattern <code class="docutils literal notranslate"><span class="pre">test*.py</span></code>.</p></li>
<li><p>Creating the test databases.</p></li>
<li><p>Running <code class="docutils literal notranslate"><span class="pre">migrate</span></code> to install models and initial data into the test
databases.</p></li>
<li><p>Running the <a class="reference internal" href="../../checks/"><span class="doc">system checks</span></a>.</p></li>
<li><p>Running the tests that were found.</p></li>
<li><p>Destroying the test databases.</p></li>
<li><p>Performing global post-test teardown.</p></li>
</ol>
<p>If you define your own test runner class and point <a class="reference internal" href="../../../ref/settings/#std-setting-TEST_RUNNER"><code class="xref std std-setting docutils literal notranslate"><span class="pre">TEST_RUNNER</span></code></a> at
that class, Django will execute your test runner whenever you run
<code class="docutils literal notranslate"><span class="pre">./manage.py</span> <span class="pre">test</span></code>. In this way, it is possible to use any test framework
that can be executed from Python code, or to modify the Django test execution
process to satisfy whatever testing requirements you may have.</p>
<section id="s-defining-a-test-runner">
<span id="s-topics-testing-test-runner"></span><span id="defining-a-test-runner"></span><span id="topics-testing-test-runner"></span><h3>Defining a test runner<a class="headerlink" href="#defining-a-test-runner" title="Link to this heading">¶</a></h3>
<p>A test runner is a class defining a <code class="docutils literal notranslate"><span class="pre">run_tests()</span></code> method. Django ships
with a <code class="docutils literal notranslate"><span class="pre">DiscoverRunner</span></code> class that defines the default Django testing
behavior. This class defines the <code class="docutils literal notranslate"><span class="pre">run_tests()</span></code> entry point, plus a
selection of other methods that are used by <code class="docutils literal notranslate"><span class="pre">run_tests()</span></code> to set up, execute
and tear down the test suite.</p>
<dl class="py class">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiscoverRunner</span></span>(<em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test*.py'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">failfast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_sql</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_tags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_name_patterns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_faulthandler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">durations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L711"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner" title="Link to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">DiscoverRunner</span></code> will search for tests in any file matching <code class="docutils literal notranslate"><span class="pre">pattern</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">top_level</span></code> can be used to specify the directory containing your
top-level Python modules. Usually Django can figure this out automatically,
so it’s not necessary to specify this option. If specified, it should
generally be the directory containing your <code class="docutils literal notranslate"><span class="pre">manage.py</span></code> file.</p>
<p><code class="docutils literal notranslate"><span class="pre">verbosity</span></code> determines the amount of notification and debug information
that will be printed to the console; <code class="docutils literal notranslate"><span class="pre">0</span></code> is no output, <code class="docutils literal notranslate"><span class="pre">1</span></code> is normal
output, and <code class="docutils literal notranslate"><span class="pre">2</span></code> is verbose output.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">interactive</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the test suite has permission to ask the
user for instructions when the test suite is executed. An example of this
behavior would be asking for permission to delete an existing test
database. If <code class="docutils literal notranslate"><span class="pre">interactive</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the test suite must be able to
run without any manual intervention.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">failfast</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the test suite will stop running after the
first test failure is detected.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">keepdb</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the test suite will use the existing database,
or create one if necessary. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, a new database will be created,
prompting the user to remove the existing one, if present.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">reverse</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, test cases will be executed in the opposite
order. This could be useful to debug tests that aren’t properly isolated
and have side effects. <a class="reference internal" href="../overview/#order-of-tests"><span class="std std-ref">Grouping by test class</span></a> is
preserved when using this option. This option can be used in conjunction
with <code class="docutils literal notranslate"><span class="pre">--shuffle</span></code> to reverse the order for a particular random seed.</p>
<p><code class="docutils literal notranslate"><span class="pre">debug_mode</span></code> specifies what the <a class="reference internal" href="../../../ref/settings/#std-setting-DEBUG"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DEBUG</span></code></a> setting should be
set to prior to running tests.</p>
<p><code class="docutils literal notranslate"><span class="pre">parallel</span></code> specifies the number of processes. If <code class="docutils literal notranslate"><span class="pre">parallel</span></code> is greater
than <code class="docutils literal notranslate"><span class="pre">1</span></code>, the test suite will run in <code class="docutils literal notranslate"><span class="pre">parallel</span></code> processes. If there are
fewer test case classes than configured processes, Django will reduce the
number of processes accordingly. Each process gets its own database. This
option requires the third-party <code class="docutils literal notranslate"><span class="pre">tblib</span></code> package to display tracebacks
correctly.</p>
<p><code class="docutils literal notranslate"><span class="pre">tags</span></code> can be used to specify a set of <a class="reference internal" href="../tools/#topics-tagging-tests"><span class="std std-ref">tags for filtering tests</span></a>. May be combined with <code class="docutils literal notranslate"><span class="pre">exclude_tags</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">exclude_tags</span></code> can be used to specify a set of
<a class="reference internal" href="../tools/#topics-tagging-tests"><span class="std std-ref">tags for excluding tests</span></a>. May be combined
with <code class="docutils literal notranslate"><span class="pre">tags</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">debug_sql</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, failing test cases will output SQL queries
logged to the <a class="reference internal" href="../../../ref/logging/#django-db-logger"><span class="std std-ref">django.db.backends logger</span></a> as well
as the traceback. If <code class="docutils literal notranslate"><span class="pre">verbosity</span></code> is <code class="docutils literal notranslate"><span class="pre">2</span></code>, then queries in all tests are
output.</p>
<p><code class="docutils literal notranslate"><span class="pre">test_name_patterns</span></code> can be used to specify a set of patterns for
filtering test methods and classes by their names.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pdb</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, a debugger (<code class="docutils literal notranslate"><span class="pre">pdb</span></code> or <code class="docutils literal notranslate"><span class="pre">ipdb</span></code>) will be spawned at
each test error or failure.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">buffer</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, outputs from passing tests will be discarded.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">enable_faulthandler</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <a class="reference external" href="https://docs.python.org/3/library/faulthandler.html#module-faulthandler" title="(in Python v3.14)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">faulthandler</span></code></a> will be
enabled.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">timing</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, test timings, including database setup and total
run time, will be shown.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">shuffle</span></code> is an integer, test cases will be shuffled in a random order
prior to execution, using the integer as a random seed. If <code class="docutils literal notranslate"><span class="pre">shuffle</span></code> is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, the seed will be generated randomly. In both cases, the seed will
be logged and set to <code class="docutils literal notranslate"><span class="pre">self.shuffle_seed</span></code> prior to running tests. This
option can be used to help detect tests that aren’t properly isolated.
<a class="reference internal" href="../overview/#order-of-tests"><span class="std std-ref">Grouping by test class</span></a> is preserved when using this
option.</p>
<p><code class="docutils literal notranslate"><span class="pre">logger</span></code> can be used to pass a Python <a class="reference external" href="https://docs.python.org/3/library/logging.html#logger" title="(in Python v3.14)"><span class="xref std std-ref">Logger object</span></a>.
If provided, the logger will be used to log messages instead of printing to
the console. The logger object will respect its logging level rather than
the <code class="docutils literal notranslate"><span class="pre">verbosity</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">durations</span></code> will show a list of the N slowest test cases. Setting this
option to <code class="docutils literal notranslate"><span class="pre">0</span></code> will result in the duration for all tests being shown.</p>
<p>Django may, from time to time, extend the capabilities of the test runner
by adding new arguments. The <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> declaration allows for this
expansion. If you subclass <code class="docutils literal notranslate"><span class="pre">DiscoverRunner</span></code> or write your own test
runner, ensure it accepts <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.</p>
<p>Your test runner may also define additional command-line options.
Create or override an <code class="docutils literal notranslate"><span class="pre">add_arguments(cls,</span> <span class="pre">parser)</span></code> class method and add
custom arguments by calling <code class="docutils literal notranslate"><span class="pre">parser.add_argument()</span></code> inside the method, so
that the <a class="reference internal" href="../../../ref/django-admin/#django-admin-test"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">test</span></code></a> command will be able to use those arguments.</p>
</dd></dl>

<section id="s-attributes">
<span id="attributes"></span><h4>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h4>
<dl class="py attribute">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.test_suite">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">test_suite</span></span><a class="headerlink" href="#django.test.runner.DiscoverRunner.test_suite" title="Link to this definition">¶</a></dt>
<dd><p>The class used to build the test suite. By default it is set to
<code class="docutils literal notranslate"><span class="pre">unittest.TestSuite</span></code>. This can be overridden if you wish to implement
different logic for collecting tests.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.test_runner">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">test_runner</span></span><a class="headerlink" href="#django.test.runner.DiscoverRunner.test_runner" title="Link to this definition">¶</a></dt>
<dd><p>This is the class of the low-level test runner which is used to execute
the individual tests and format the results. By default it is set to
<code class="docutils literal notranslate"><span class="pre">unittest.TextTestRunner</span></code>. Despite the unfortunate similarity in
naming conventions, this is not the same type of class as
<code class="docutils literal notranslate"><span class="pre">DiscoverRunner</span></code>, which covers a broader set of responsibilities. You
can override this attribute to modify the way tests are run and reported.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.test_loader">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">test_loader</span></span><a class="headerlink" href="#django.test.runner.DiscoverRunner.test_loader" title="Link to this definition">¶</a></dt>
<dd><p>This is the class that loads tests, whether from TestCases or modules or
otherwise and bundles them into test suites for the runner to execute.
By default it is set to <code class="docutils literal notranslate"><span class="pre">unittest.defaultTestLoader</span></code>. You can override
this attribute if your tests are going to be loaded in unusual ways.</p>
</dd></dl>

</section>
<section id="s-methods">
<span id="methods"></span><h4>Methods<a class="headerlink" href="#methods" title="Link to this heading">¶</a></h4>
<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.run_tests">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">run_tests</span></span>(<em class="sig-param"><span class="n"><span class="pre">test_labels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1121"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.run_tests" title="Link to this definition">¶</a></dt>
<dd><p>Run the test suite.</p>
<p><code class="docutils literal notranslate"><span class="pre">test_labels</span></code> allows you to specify which tests to run and supports
several formats (see <a class="reference internal" href="#django.test.runner.DiscoverRunner.build_suite" title="django.test.runner.DiscoverRunner.build_suite"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DiscoverRunner.build_suite()</span></code></a> for a list of
supported formats).</p>
<p>This method should return the number of tests that failed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.add_arguments">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">add_arguments</span></span>(<em class="sig-param"><span class="n"><span class="pre">parser</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L782"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.add_arguments" title="Link to this definition">¶</a></dt>
<dd><p>Override this class method to add custom arguments accepted by the
<a class="reference internal" href="../../../ref/django-admin/#django-admin-test"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">test</span></code></a> management command. See
<a class="reference external" href="https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser.add_argument" title="(in Python v3.14)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">argparse.ArgumentParser.add_argument()</span></code></a> for details about adding
arguments to a parser.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.setup_test_environment">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">setup_test_environment</span></span>(<em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L917"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.setup_test_environment" title="Link to this definition">¶</a></dt>
<dd><p>Sets up the test environment by calling
<a class="reference internal" href="#django.test.utils.setup_test_environment" title="django.test.utils.setup_test_environment"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup_test_environment()</span></code></a> and setting
<a class="reference internal" href="../../../ref/settings/#std-setting-DEBUG"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DEBUG</span></code></a> to <code class="docutils literal notranslate"><span class="pre">self.debug_mode</span></code> (defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.build_suite">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">build_suite</span></span>(<em class="sig-param"><span class="n"><span class="pre">test_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L975"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.build_suite" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a test suite that matches the test labels provided.</p>
<p><code class="docutils literal notranslate"><span class="pre">test_labels</span></code> is a list of strings describing the tests to be run. A test
label can take one of four forms:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path.to.test_module.TestCase.test_method</span></code> – Run a single test method
in a test case class.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path.to.test_module.TestCase</span></code> – Run all the test methods in a test
case.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path.to.module</span></code> – Search for and run all tests in the named Python
package or module.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path/to/directory</span></code> – Search for and run all tests below the named
directory.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">test_labels</span></code> has a value of <code class="docutils literal notranslate"><span class="pre">None</span></code>, the test runner will search for
tests in all files below the current directory whose names match its
<code class="docutils literal notranslate"><span class="pre">pattern</span></code> (see above).</p>
<p>Returns a <code class="docutils literal notranslate"><span class="pre">TestSuite</span></code> instance ready to be run.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.setup_databases">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">setup_databases</span></span>(<em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1036"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.setup_databases" title="Link to this definition">¶</a></dt>
<dd><p>Creates the test databases by calling
<a class="reference internal" href="#django.test.utils.setup_databases" title="django.test.utils.setup_databases"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup_databases()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.run_checks">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">run_checks</span></span>(<em class="sig-param"><span class="n"><span class="pre">databases</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1063"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.run_checks" title="Link to this definition">¶</a></dt>
<dd><p>Runs the <a class="reference internal" href="../../checks/"><span class="doc">system checks</span></a> on the test <code class="docutils literal notranslate"><span class="pre">databases</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.run_suite">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">run_suite</span></span>(<em class="sig-param"><span class="n"><span class="pre">suite</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1068"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.run_suite" title="Link to this definition">¶</a></dt>
<dd><p>Runs the test suite.</p>
<p>Returns the result produced by the running the test suite.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.get_test_runner_kwargs">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">get_test_runner_kwargs</span></span>()<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1053"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.get_test_runner_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Returns the keyword arguments to instantiate the
<code class="docutils literal notranslate"><span class="pre">DiscoverRunner.test_runner</span></code> with.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.teardown_databases">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">teardown_databases</span></span>(<em class="sig-param"><span class="n"><span class="pre">old_config</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1078"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.teardown_databases" title="Link to this definition">¶</a></dt>
<dd><p>Destroys the test databases, restoring pre-test conditions by calling
<a class="reference internal" href="#django.test.utils.teardown_databases" title="django.test.utils.teardown_databases"><code class="xref py py-func docutils literal notranslate"><span class="pre">teardown_databases()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.teardown_test_environment">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">teardown_test_environment</span></span>(<em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1087"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.teardown_test_environment" title="Link to this definition">¶</a></dt>
<dd><p>Restores the pre-test environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.suite_result">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">suite_result</span></span>(<em class="sig-param"><span class="n"><span class="pre">suite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L1091"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.suite_result" title="Link to this definition">¶</a></dt>
<dd><p>Computes and returns a return code based on a test suite, and the result
from that test suite.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="django.test.runner.DiscoverRunner.log">
<span class="sig-prename descclassname"><span class="pre">DiscoverRunner.</span></span><span class="sig-name descname"><span class="pre">log</span></span>(<em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/runner.py#L899"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.runner.DiscoverRunner.log" title="Link to this definition">¶</a></dt>
<dd><p>If a <code class="docutils literal notranslate"><span class="pre">logger</span></code> is set, logs the message at the given integer
<a class="reference external" href="https://docs.python.org/3/library/logging.html#levels">logging level</a> (e.g. <code class="docutils literal notranslate"><span class="pre">logging.DEBUG</span></code>, <code class="docutils literal notranslate"><span class="pre">logging.INFO</span></code>, or
<code class="docutils literal notranslate"><span class="pre">logging.WARNING</span></code>). Otherwise, the message is printed to the console,
respecting the current <code class="docutils literal notranslate"><span class="pre">verbosity</span></code>. For example, no message will be
printed if the <code class="docutils literal notranslate"><span class="pre">verbosity</span></code> is 0, <code class="docutils literal notranslate"><span class="pre">INFO</span></code> and above will be printed if
the <code class="docutils literal notranslate"><span class="pre">verbosity</span></code> is at least 1, and <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> will be printed if it is at
least 2. The <code class="docutils literal notranslate"><span class="pre">level</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">logging.INFO</span></code>.</p>
</dd></dl>

</section>
</section>
<section id="s-testing-utilities">
<span id="testing-utilities"></span><h3>Testing utilities<a class="headerlink" href="#testing-utilities" title="Link to this heading">¶</a></h3>
<section id="s-module-django.test.utils">
<span id="s-django-test-utils"></span><span id="module-django.test.utils"></span><span id="django-test-utils"></span><h4><code class="docutils literal notranslate"><span class="pre">django.test.utils</span></code><a class="headerlink" href="#module-django.test.utils" title="Link to this heading">¶</a></h4>
<p>To assist in the creation of your own test runner, Django provides a number of
utility methods in the <code class="docutils literal notranslate"><span class="pre">django.test.utils</span></code> module.</p>
<dl class="py function">
<dt class="sig sig-object py" id="django.test.utils.setup_test_environment">
<span class="sig-name descname"><span class="pre">setup_test_environment</span></span>(<em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/utils.py#L121"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.utils.setup_test_environment" title="Link to this definition">¶</a></dt>
<dd><p>Performs global pre-test setup, such as installing instrumentation for the
template rendering system and setting up the dummy email outbox.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">debug</span></code> isn’t <code class="docutils literal notranslate"><span class="pre">None</span></code>, the <a class="reference internal" href="../../../ref/settings/#std-setting-DEBUG"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DEBUG</span></code></a> setting is updated to its
value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="django.test.utils.teardown_test_environment">
<span class="sig-name descname"><span class="pre">teardown_test_environment</span></span>()<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/utils.py#L159"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.utils.teardown_test_environment" title="Link to this definition">¶</a></dt>
<dd><p>Performs global post-test teardown, such as removing instrumentation from
the template system and restoring normal email services.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="django.test.utils.setup_databases">
<span class="sig-name descname"><span class="pre">setup_databases</span></span>(<em class="sig-param"><span class="n"><span class="pre">verbosity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_keeper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_sql</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">serialized_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/utils.py#L176"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.utils.setup_databases" title="Link to this definition">¶</a></dt>
<dd><p>Creates the test databases.</p>
<p>Returns a data structure that provides enough detail to undo the changes
that have been made. This data will be provided to the
<a class="reference internal" href="#django.test.utils.teardown_databases" title="django.test.utils.teardown_databases"><code class="xref py py-func docutils literal notranslate"><span class="pre">teardown_databases()</span></code></a> function at the conclusion of testing.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">aliases</span></code> argument determines which <a class="reference internal" href="../../../ref/settings/#std-setting-DATABASES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DATABASES</span></code></a> aliases test
databases should be set up for. If it’s not provided, it defaults to all of
<a class="reference internal" href="../../../ref/settings/#std-setting-DATABASES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DATABASES</span></code></a> aliases.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">serialized_aliases</span></code> argument determines what subset of <code class="docutils literal notranslate"><span class="pre">aliases</span></code>
test databases should have their state serialized to allow usage of the
<a class="reference internal" href="../overview/#test-case-serialized-rollback"><span class="std std-ref">serialized_rollback</span></a> feature. If
it’s not provided, it defaults to <code class="docutils literal notranslate"><span class="pre">aliases</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="django.test.utils.teardown_databases">
<span class="sig-name descname"><span class="pre">teardown_databases</span></span>(<em class="sig-param"><span class="n"><span class="pre">old_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>)<a class="reference external" href="https://github.com/django/django/blob/stable/6.0.x/django/test/utils.py#L370"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#django.test.utils.teardown_databases" title="Link to this definition">¶</a></dt>
<dd><p>Destroys the test databases, restoring pre-test conditions.</p>
<p><code class="docutils literal notranslate"><span class="pre">old_config</span></code> is a data structure defining the changes in the database
configuration that need to be reversed. It’s the return value of the
<a class="reference internal" href="#django.test.utils.setup_databases" title="django.test.utils.setup_databases"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_databases()</span></code></a> method.</p>
</dd></dl>

</section>
<section id="s-django-db-connection-creation">
<span id="django-db-connection-creation"></span><h4><code class="docutils literal notranslate"><span class="pre">django.db.connection.creation</span></code><a class="headerlink" href="#django-db-connection-creation" title="Link to this heading">¶</a></h4>
<p>The creation module of the database backend also provides some utilities that
can be useful during testing.</p>
<dl class="py function">
<dt class="sig sig-object py" id="django.db.connection.creation.create_test_db">
<span class="sig-name descname"><span class="pre">create_test_db</span></span>(<em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autoclobber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>)<a class="headerlink" href="#django.db.connection.creation.create_test_db" title="Link to this definition">¶</a></dt>
<dd><p>Creates a new test database and runs <code class="docutils literal notranslate"><span class="pre">migrate</span></code> against it.</p>
<p><code class="docutils literal notranslate"><span class="pre">verbosity</span></code> has the same behavior as in <code class="docutils literal notranslate"><span class="pre">run_tests()</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">autoclobber</span></code> describes the behavior that will occur if a
database with the same name as the test database is discovered:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">autoclobber</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the user will be asked to
approve destroying the existing database. <code class="docutils literal notranslate"><span class="pre">sys.exit</span></code> is
called if the user does not approve.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">autoclobber</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the database will be destroyed
without consulting the user.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">keepdb</span></code> determines if the test run should use an existing
database, or create a new one. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the existing
database will be used, or created if not present. If <code class="docutils literal notranslate"><span class="pre">False</span></code>,
a new database will be created, prompting the user to remove
the existing one, if present.</p>
<p>Returns the name of the test database that it created.</p>
<p><code class="docutils literal notranslate"><span class="pre">create_test_db()</span></code> has the side effect of modifying the value of
<a class="reference internal" href="../../../ref/settings/#std-setting-NAME"><code class="xref std std-setting docutils literal notranslate"><span class="pre">NAME</span></code></a> in <a class="reference internal" href="../../../ref/settings/#std-setting-DATABASES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DATABASES</span></code></a> to match the name of the test
database.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 6.0: </span>The <code class="docutils literal notranslate"><span class="pre">serialize</span></code> keyword argument is deprecated. Passing
<code class="docutils literal notranslate"><span class="pre">serialize=True</span></code> would automatically call
<a class="reference internal" href="#django.db.connection.creation.serialize_db_to_string" title="django.db.connection.creation.serialize_db_to_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">serialize_db_to_string()</span></code></a> but it was deprecated as it could result
in queries against non-test databases during serialization.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="django.db.connection.creation.destroy_test_db">
<span class="sig-name descname"><span class="pre">destroy_test_db</span></span>(<em class="sig-param"><span class="n"><span class="pre">old_database_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>)<a class="headerlink" href="#django.db.connection.creation.destroy_test_db" title="Link to this definition">¶</a></dt>
<dd><p>Destroys the database whose name is the value of <a class="reference internal" href="../../../ref/settings/#std-setting-NAME"><code class="xref std std-setting docutils literal notranslate"><span class="pre">NAME</span></code></a> in
<a class="reference internal" href="../../../ref/settings/#std-setting-DATABASES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DATABASES</span></code></a>, and sets <a class="reference internal" href="../../../ref/settings/#std-setting-NAME"><code class="xref std std-setting docutils literal notranslate"><span class="pre">NAME</span></code></a> to the value of
<code class="docutils literal notranslate"><span class="pre">old_database_name</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">verbosity</span></code> argument has the same behavior as for
<a class="reference internal" href="#django.test.runner.DiscoverRunner" title="django.test.runner.DiscoverRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscoverRunner</span></code></a>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">keepdb</span></code> argument is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the connection to the
database will be closed, but the database will not be destroyed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="django.db.connection.creation.serialize_db_to_string">
<span class="sig-name descname"><span class="pre">serialize_db_to_string</span></span>()<a class="headerlink" href="#django.db.connection.creation.serialize_db_to_string" title="Link to this definition">¶</a></dt>
<dd><p>Serializes the database into an in-memory JSON string that can be used to
restore the database state between tests if the backend doesn’t support
transactions or if your suite contains test classes with
<a class="reference internal" href="../overview/#test-case-serialized-rollback"><span class="std std-ref">serialized_rollback=True</span></a> enabled.</p>
<p>This function should only be called once all test databases have been
created as the serialization process could result in queries against
non-test databases depending on your
<a class="reference internal" href="../../db/multi-db/#topics-db-multi-db-routing"><span class="std std-ref">routing configuration</span></a>.</p>
</dd></dl>

</section>
</section>
</section>
<section id="s-integration-with-coverage-py">
<span id="s-topics-testing-code-coverage"></span><span id="integration-with-coverage-py"></span><span id="topics-testing-code-coverage"></span><h2>Integration with <code class="docutils literal notranslate"><span class="pre">coverage.py</span></code><a class="headerlink" href="#integration-with-coverage-py" title="Link to this heading">¶</a></h2>
<p>Code coverage describes how much source code has been tested. It shows which
parts of your code are being exercised by tests and which are not. It’s an
important part of testing applications, so it’s strongly recommended to check
the coverage of your tests.</p>
<p>Django can be easily integrated with <a class="reference external" href="https://coverage.readthedocs.io/">coverage.py</a>, a tool for measuring code
coverage of Python programs. First, install <a class="extlink-pypi reference external" href="https://pypi.org/project/coverage/">coverage</a>. Next, run the
following from your project folder containing <code class="docutils literal notranslate"><span class="pre">manage.py</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>coverage<span class="w"> </span>run<span class="w"> </span>--source<span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="w"> </span>manage.py<span class="w"> </span><span class="nb">test</span><span class="w"> </span>myapp
</pre></div>
</div>
<p>This runs your tests and collects coverage data of the executed files in your
project. You can see a report of this data by typing following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>coverage<span class="w"> </span>report
</pre></div>
</div>
<p>Note that some Django code was executed while running tests, but it is not
listed here because of the <code class="docutils literal notranslate"><span class="pre">source</span></code> flag passed to the previous command.</p>
<p>For more options like annotated HTML listings detailing missed lines, see the
<a class="reference external" href="https://coverage.readthedocs.io/">coverage.py</a> docs.</p>
</section>
</section>

    </article>
  

  
    <nav class="browse-horizontal" aria-labelledby="browse-horizontal-header">
      <span id="browse-horizontal-header" class="visuallyhidden">Previous page and next page</span>
      
        <div class="left"><a rel="prev" href="../tools/"><i class="icon icon-chevron-left"></i> Testing tools</a></div>
      
      
        <div class="right"><a rel="next" href="../../auth/">User authentication in Django <i class="icon icon-chevron-right"></i></a></div>
      
    </nav>
  


        <a href="#top" class="backtotop"><i class="icon icon-chevron-up"></i> Back to Top</a>
      </main>

      
  <div role="complementary">
    <h2 class="visuallyhidden" id="aside-header">Additional Information</h2>

    


  <div class="fundraising-sidebar">
    <h3>Support Django!</h3>

    <div class="small-heart">
      <img src="https://static.djangoproject.com/img/fundraising-heart.cd6bb84ffd33.svg" alt="Support Django!" />
    </div>

    <div class="small-cta">
      <ul class="list-links-small">
        <li><a href="https://www.djangoproject.com/fundraising/">
          Dae donated to the Django Software Foundation to support Django development. Donate today!
        </a></li>
      </ul>
    </div>
  </div>



    
      <h3>Contents</h3>
      
        <ul>
<li><a class="reference internal" href="#">Advanced testing topics</a><ul>
<li><a class="reference internal" href="#the-request-factory">The request factory</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#asyncrequestfactory">AsyncRequestFactory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-class-based-views">Testing class-based views</a></li>
<li><a class="reference internal" href="#tests-and-multiple-host-names">Tests and multiple host names</a></li>
<li><a class="reference internal" href="#tests-and-multiple-databases">Tests and multiple databases</a><ul>
<li><a class="reference internal" href="#testing-primary-replica-configurations">Testing primary/replica configurations</a></li>
<li><a class="reference internal" href="#controlling-creation-order-for-test-databases">Controlling creation order for test databases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-features-of-transactiontestcase">Advanced features of <code class="docutils literal notranslate"><span class="pre">TransactionTestCase</span></code></a></li>
<li><a class="reference internal" href="#enforce-running-test-classes-sequentially">Enforce running test classes sequentially</a></li>
<li><a class="reference internal" href="#using-the-django-test-runner-to-test-reusable-applications">Using the Django test runner to test reusable applications</a></li>
<li><a class="reference internal" href="#using-different-testing-frameworks">Using different testing frameworks</a><ul>
<li><a class="reference internal" href="#defining-a-test-runner">Defining a test runner</a><ul>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-utilities">Testing utilities</a><ul>
<li><a class="reference internal" href="#module-django.test.utils"><code class="docutils literal notranslate"><span class="pre">django.test.utils</span></code></a></li>
<li><a class="reference internal" href="#django-db-connection-creation"><code class="docutils literal notranslate"><span class="pre">django.db.connection.creation</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#integration-with-coverage-py">Integration with <code class="docutils literal notranslate"><span class="pre">coverage.py</span></code></a></li>
</ul>
</li>
</ul>

      
    

    
      <nav aria-labelledby="browse-header">
        <h3 id="browse-header">Browse</h3>
        <ul>
          
            
              <li>Prev: <a rel="prev" href="../tools/">Testing tools</a></li>
            
            
              <li>Next: <a rel="next" href="../../auth/">User authentication in Django</a></li>
            
            <li><a href="https://docs.djangoproject.com/en/6.0/contents/">Table of contents</a></li>
            
              <li><a href="https://docs.djangoproject.com/en/6.0/genindex/">General Index</a></li>
            
              <li><a href="https://docs.djangoproject.com/en/6.0/py-modindex/">Python Module Index</a></li>
            
          
        </ul>
      </nav>
    

    
      <nav aria-labelledby="breadcrumbs-header">
        <h3 id="breadcrumbs-header">You are here:</h3>
        <ul>
          <li>
            <a href="https://docs.djangoproject.com/en/6.0/">Django 6.0 documentation</a>
            
              <ul><li><a href="../../">Using Django</a>
            
              <ul><li><a href="../">Testing in Django</a>
            
            <ul><li>Advanced testing topics</li></ul>
            </li></ul></li></ul>
          </li>
        </ul>
      </nav>
    

    
      <section aria-labelledby="getting-help-sidebar">
        <h3 id="getting-help-sidebar">Getting help</h3>
        <dl class="list-links">
          <dt><a href="https://docs.djangoproject.com/en/6.0/faq/">FAQ</a></dt>
          <dd>Try the FAQ — it's got answers to many common questions.</dd>

          <dt><a href="/en/stable/genindex/">Index</a>, <a href="/en/stable/py-modindex/">Module Index</a>, or <a href="/en/stable/contents/">Table of Contents</a></dt>
          <dd>Handy when looking for specific information.</dd>

          <dt><a href="https://chat.djangoproject.com">Django Discord Server</a></dt>
          <dd>Join the Django Discord Community.</dd>

          <dt><a href="https://forum.djangoproject.com/">Official Django Forum</a></dt>
          <dd>Join the community on the Django Forum.</dd>

          <dt><a href="https://code.djangoproject.com/">Ticket tracker</a></dt>
          <dd>Report bugs with Django or Django documentation in our ticket tracker.</dd>
        </dl>
      </section>
    

    
      <section aria-labelledby="links-wrapper-header">
        <h3 id="links-wrapper-header">Download:</h3>
        <p>
          Offline (Django 6.0):
          <a href="https://media.djangoproject.com/docs/django-docs-6.0-en.zip">HTML</a> |
          <a href="https://media.readthedocs.org/pdf/django/6.0.x/django.pdf">PDF</a> |
          <a href="https://media.readthedocs.org/epub/django/6.0.x/django.epub">ePub</a>
          <br>
          <span class="quiet">
            Provided by <a href="https://readthedocs.org/">Read the Docs</a>.
          </span>
        </p>
      </section>
    

    
  <div class="corporate-members">
    <h3>Diamond and Platinum Members</h3>
    
      <div class="clearfix">
        <div class="member-logo">
          <a href="https://sentry.io/for/django/" title="Sentry">
            <img src="https://media.djangoproject.com/cache/7a/f9/7af9c770dc49465739a82c91a0eb3d51.png" alt="Sentry" />
          </a>
        </div>
        <div class="small-cta">
          <ul class="list-links-small">
            <li><strong>Sentry</strong></li>
            <li><a href="https://sentry.io/for/django/" title="Sentry">
              Monitor your Django Code
Resolve performance bottlenecks and errors using monitoring, replays, logs and Seer an AI agent for debugging.
            </a></li>
          </ul>
        </div>
      </div>
    
      <div class="clearfix">
        <div class="member-logo">
          <a href="https://jb.gg/ybja10" title="JetBrains">
            <img src="https://media.djangoproject.com/cache/c0/ea/c0ea128467983e64aab91cd27e7918c0.png" alt="JetBrains" />
          </a>
        </div>
        <div class="small-cta">
          <ul class="list-links-small">
            <li><strong>JetBrains</strong></li>
            <li><a href="https://jb.gg/ybja10" title="JetBrains">
              JetBrains delivers intelligent software solutions that make developers more productive by simplifying their challenging tasks, automating the routine, and helping them adopt the best development practices. PyCharm is the Python IDE for Professional Developers by JetBrains providing a complete set of tools for productive Python, Web and scientific development.
            </a></li>
          </ul>
        </div>
      </div>
    
  </div>


  </div>

      

    </div>

     
     

    
    
    

    <!-- SVGs -->
    <svg xmlns="http://www.w3.org/2000/svg">
      <symbol viewBox="0 0 24 24" id="icon-auto"><path d="M0 0h24v24H0z" fill="currentColor"/><path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2V4a8 8 0 1 0 0 16z"/></symbol>
      <symbol viewBox="0 0 24 24" id="icon-moon"><path d="M0 0h24v24H0z" fill="currentColor"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol>
      <symbol viewBox="0 0 24 24" id="icon-sun"><path d="M0 0h24v24H0z" fill="currentColor"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol>
    </svg>
    <!-- END SVGs -->

    
      

<footer>
  <div class="subfooter">
    <div class="container">
      <h2 class="visuallyhidden">Django Links</h2>
      <div class="column-container">
        <div class="col-learn-more">
          <h3>Learn More</h3>
          <ul>
            <li><a href="https://www.djangoproject.com/start/overview/">About Django</a></li>
            
            <li><a href="https://www.djangoproject.com/start/">Getting Started with Django</a></li>
            <li><a href="https://www.djangoproject.com/foundation/teams/">Team Organization</a></li>
            <li><a href="https://www.djangoproject.com/foundation/">Django Software Foundation</a></li>
            <li><a href="https://www.djangoproject.com/conduct/">Code of Conduct</a></li>
            <li><a href="https://www.djangoproject.com/diversity/">Diversity Statement</a></li>
          </ul>
        </div>

        <div class="col-get-involved">
          <h3>Get Involved</h3>
          <ul>
            <li><a href="https://www.djangoproject.com/community/">Join a Group</a></li>
            <li><a href="https://docs.djangoproject.com/en/dev/internals/contributing/">Contribute
              to Django</a></li>
            <li><a
              href="https://docs.djangoproject.com/en/dev/internals/contributing/bugs-and-features/">Submit
              a Bug</a></li>
            <li><a
              href="https://docs.djangoproject.com/en/dev/internals/security/#reporting-security-issues">Report
              a Security Issue</a></li>
            <li><a href="https://www.djangoproject.com/foundation/individual-members/">Individual membership</a></li>
          </ul>
        </div>

        <div class="col-get-help">
          <h3>Get Help</h3>
          <ul>
            <li><a href="https://docs.djangoproject.com/en/stable/faq/">Getting Help FAQ</a>
            </li>
            <li><a href="https://chat.djangoproject.com" target="_blank">Django Discord</a></li>
            <li><a href="https://forum.djangoproject.com/" target="_blank">Official Django Forum</a></li>
          </ul>
        </div>

        <div class="col-follow-us">
          <h3>Follow Us</h3>
          <ul>
            <li><a href="https://github.com/django">GitHub</a></li>
            <li><a href="https://x.com/djangoproject">X</a></li>
            <li><a href="https://fosstodon.org/@django" rel="me">Fediverse (Mastodon)</a></li>
            <li><a href="https://bsky.app/profile/djangoproject.com">Bluesky</a></li>
            <li><a href="https://www.linkedin.com/company/django-software-foundation">LinkedIn</a></li>
            <li><a href="https://www.djangoproject.com/rss/weblog/">News RSS</a></li>
          </ul>
        </div>

        <div class="col-support-us">
          <h3>Support Us</h3>
          <ul>
            <li><a href="https://www.djangoproject.com/fundraising/">Sponsor Django</a></li>
            <li><a href="https://www.djangoproject.com/foundation/corporate-membership/">Corporate membership</a></li>
            <li><a href="https://django.threadless.com/" target="_blank">Official merchandise store</a></li>
            <li><a href="https://www.djangoproject.com/foundation/donate/#benevity-giving">Benevity Workplace Giving Program</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <div class="container">
      <div class="footer-logo">
        <a class="logo" href="https://www.djangoproject.com/">Django</a>
      </div>
      <ul class="thanks">
        <li>
          <span>Hosting by</span> <a class="in-kind-donors" href="https://www.djangoproject.com/fundraising/#in-kind-donors">In-kind
            donors</a>
        </li>
        <li class="design"><span>Design by</span> <a class="threespot" href="https://www.threespot.com">Threespot</a>
          <span class="ampersand">&amp;</span> <a class="andrevv" href="http://andrevv.com/">andrevv</a></li>
      </ul>
      <p class="copyright">&copy; 2005-2025
        <a href="https://www.djangoproject.com/foundation/"> Django Software
          Foundation</a> and individual contributors. Django is a
        <a href="https://www.djangoproject.com/trademarks/">registered
          trademark</a> of the Django Software Foundation.
      </p>
    </div>
  </div>

</footer>

    

    
  


    
      
      <script>
        function extless(input) {
          return input.replace(/(.*)\.[^.]+$/, '$1');
        }
        var require = {
          shim: {
            'jquery': [],
            'stripe': {
              exports: 'Stripe'
            }
          },
          paths: {
            "jquery": extless("https://static.djangoproject.com/js/lib/jquery.min.5790ead7ad3b.js"),
            "mod/list-collapsing": extless("https://static.djangoproject.com/js/mod/list-collapsing.2d844151b2ec.js"),
            "mod/stripe-change-card": extless("https://static.djangoproject.com/js/mod/stripe-change-card.eaa0afc324e9.js"),
            "mod/switch-dark-mode": extless("https://static.djangoproject.com/js/mod/switch-dark-mode.139625c684db.js"),
            "stripe-checkout": "https://checkout.stripe.com/checkout",
            "stripe": "https://js.stripe.com/v3/?" // ? needed due to require.js
          }
        };
      </script>
      <script data-main="https://static.djangoproject.com/js/main.8677b21133eb.js" src="https://static.djangoproject.com/js/lib/require.177879fbe7dd.js"></script>
      <script src="https://static.djangoproject.com/js/djangoproject.15c016c8c3a7.js"></script>
    
  </body>
</html>
